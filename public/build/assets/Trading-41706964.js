import{_ as le}from"./preload-helper-f61836a9.js";import{M as ve}from"./Markets-3a69d2af.js";import be from"./Trades-f4d8c6d3.js";import pe from"./Marketinfo-354c83b0.js";import{C as X,K as de}from"./flowbite-vue-19d13a06.js";import{u as j}from"./market-b51fc72c.js";import{u as _e}from"./wallets-0baf959a.js";import{u as ue}from"./user-d2ff915e.js";import{_ as I,o as n,c as u,h as A,W as Y,a,b as ae,F as z,d as W,q as $,t as s,n as P,k as v,r as p,i as g,bT as he,u as Z,l as B,e as L,f as O,w as h,g as S,X as oe,T as me,x as se,bf as ke,m as xe,b8 as Pe,j as ce,y as we,an as Se}from"./bootstrap-2a895a5a.js";import{A as Le,T as Te,P as Ae}from"./PriceInput-808903ab.js";import{C as ge}from"./Col-7414d455.js";import{t as ne}from"./toMoney-156545ac.js";import{t as ie}from"./toDate-e910adc1.js";import Ce from"./Orderbook-a6f60ecf.js";/* empty css                                                                       */import"./LoadingCircles-0aeda322.js";import"./_commonjsHelpers-de833af9.js";import"./browser-77dd377d.js";import"./axios-4a70c6fc.js";import"./ListItem-81ee6613.js";const Oe={props:{range:[Number,String],minLeverage:[Number,String],maxLeverage:[Number,String]},emits:["calculatePercentage"],data(){return{localLeverage:Math.round(this.range),showMS:!1}},computed:{leverageRange(){return this.maxLeverage-this.minLeverage},leveragePercentages(){let t=[];t.push(this.minLeverage);for(let r=25;r<=this.maxLeverage;r+=25)t.push(r);return t}},watch:{range(t){this.localLeverage=Math.round(t)}},methods:{calculatePercentageButton(t){this.localLeverage=Math.round(t/this.maxLeverage*100),this.$emit("calculatePercentage",this.localLeverage)},calculatePercentage(){this.localLeverage=Math.round(this.localLeverage),this.$emit("calculatePercentage",this.localLeverage)}}},Me={class:"rc-slider-mark"},Be=["onClick"],Fe={class:"rc-slider-step"},$e=["onClick"];function Ie(t,r,o,e,d,l){return n(),u("div",{class:"group relative",onMouseover:r[2]||(r[2]=i=>d.showMS=!0),onMouseleave:r[3]||(r[3]=i=>d.showMS=!1)},[A(a("input",{"onUpdate:modelValue":r[0]||(r[0]=i=>d.localLeverage=i),type:"range",min:"0",max:"100",step:"1",class:"rc-slider",style:ae({background:`linear-gradient(to right, #01bc8d 0%, #01bc8d ${d.localLeverage}%, rgb(200 200 200 / 0.2) ${d.localLeverage}%, rgb(200 200 200 / 0.2) 100%)`}),onChange:r[1]||(r[1]=i=>l.calculatePercentage())},null,36),[[Y,d.localLeverage]]),a("div",Me,[(n(!0),u(z,null,W(l.leveragePercentages,i=>(n(),u("div",{key:i,class:"rc-slider-mark-text",style:ae({left:`calc(${i/l.leverageRange*100}% ${i===l.leveragePercentages[l.leveragePercentages.length-1]?"- 20px":i!==l.leveragePercentages[0]?"- 14px":""})`}),onClick:$(c=>l.calculatePercentageButton(i),["prevent"])},s(i)+"x ",13,Be))),128))]),a("div",Fe,[(n(!0),u(z,null,W(l.leveragePercentages,i=>(n(),u("div",{key:i,class:P(["rc-slider-dot",{"rc-slider-dot-active":o.range>=i/l.leverageRange*100}]),style:ae({left:`calc(${i/l.leverageRange*100}% ${i===l.leveragePercentages[l.leveragePercentages.length-1]?"- 14px":i!==l.leveragePercentages[0]?"- 8px":""})`}),onClick:$(c=>l.calculatePercentageButton(i),["prevent"])},null,14,$e))),128))])],32)}const qe=I(Oe,[["render",Ie],["__scopeId","data-v-8a614f3e"]]),Ne={components:{Range:qe},props:{minLeverage:[Number,String],maxLeverage:[Number,String],stepLeverage:{type:Number,default:1},modelValue:{type:[Number,String],default:1},disabled:{type:Boolean,default:!1}},emits:["calculateTotal","update:modelValue"],setup(t,{emit:r}){const o=v(0),e=v("LeverageInput leverage-input disabled:opacity-50");return{range:o,leverageTypeClass:e,changeLeverage:i=>{const c=i==="increase"?parseFloat(t.modelValue)+t.stepLeverage:parseFloat(t.modelValue)-t.stepLeverage;if(c>=t.minLeverage&&c<=t.maxLeverage){const m=Number(c);r("update:modelValue",m)}},RangeHandler:i=>{o.value=i;const c=t.minLeverage+(t.maxLeverage-t.minLeverage)*i/100;r("update:modelValue",Math.round(c))}}}},Ve={for:"leverage",class:"border-1 leverage-label peer pb-2"},ze={class:"text-left"};function Re(t,r,o,e,d,l){const i=p("Range");return n(),u("label",Ve,[a("span",ze,s(t.$t("Leverage"))+": x"+s(o.modelValue),1),g(i,{range:e.range,onCalculatePercentage:e.RangeHandler,minLeverage:o.minLeverage,maxLeverage:o.maxLeverage},null,8,["range","onCalculatePercentage","minLeverage","maxLeverage"])])}const Ee=I(Ne,[["render",Re]]),De={components:{Button:X,AmountInput:Le,TotalInput:Te,PriceInput:Ae,Leverage:Ee},props:{orderType:String,formType:String,currency:String,pair:String,fee:[Number,String]},emits:["OrderPlaced","leverage"],setup(t,{emit:r}){const{t:o}=he(),e=j(),d=v(1e-4),l=v(1),i=v(1),c=v(1),m=v(!1),b=window.provider,f=window.plat;Z(()=>e.future,k=>{k&&k.limits.amount.min&&(d.value=Number.parseFloat(k.limits.amount.min)),k&&k.contractSize&&(l.value=Number.parseFloat(k.contractSize)),k&&k.limits.leverage.min&&(i.value=Number.parseFloat(k.limits.leverage.min),c.value=Number.parseFloat(k.limits.leverage.max),r("leverage",c.value)),m.value=!0},{immediate:!0});const y=B(()=>{var k,T,F;return Number.parseFloat((F=(T=(k=e==null?void 0:e.future)==null?void 0:k.limits)==null?void 0:T.amount)==null?void 0:F.max)||1e4}),_=v(1),x=B(()=>{var k,T,F,N;if(e.future&&((T=(k=e==null?void 0:e.future)==null?void 0:k.precision)!=null&&T.amount)){const V=Number.parseFloat((N=(F=e==null?void 0:e.future)==null?void 0:F.precision)==null?void 0:N.amount);if(Number.isInteger(V))return V;{const G=V.toString().match(/(\d+(\.\d+)?)[eE][+-]\d+/);if(G){const ye=(parseFloat(G[1]).toString().split(".")[1]||"").length,fe=parseInt(G[0].split(/e|E/)[1]);return ye+Math.abs(fe)}else return V.toString().split(".")[1].length}}return 6}),C=v(d.value??0),R=v(0),M=v(0),q=B(()=>t.formType+(t.orderType==="buy"?"OrderBtnBuy":"OrderBtnSell")),U=B(()=>t.orderType==="buy"?"green":"red"),E=B(()=>t.formType=="market"?t.orderType==="buy"?e.bestAsk>0:e.bestBid>0:!0),ee=B(()=>E.value?t.orderType==="buy"?o("Buy/Long"):o("Sell/Short"):"Loading Orderbook..."),te=B(()=>f.futures&&f.futures.leverage_range==="fixed_leverage"?f.futures.fixed_leverage_amount:f.futures&&f.futures.leverage_range==="one_leverage"?c.value:_.value),J=async()=>{try{await e.executeTrade(t.orderType,t.formType,t.formType==="market"?w.value:M.value,C.value,t.currency,t.pair,te.value,e.future.id,l.value),r("OrderPlaced")}catch(k){$toast.error("Error executing trade:",k)}},H=(k,T)=>{const F=t.formType==="market"?w.value:M.value,N=t.fee/100,V=k*(T/100)/F,G=V*N;return parseFloat(V-G).toFixed(x.value)};Z(C,()=>{D()}),Z(M,()=>{D()});const re=k=>{if(!t.currency&&!t.pair){$toast.error(`Create ${t.orderType==="buy"?t.pair:t.currency} Wallet First`);return}if(!e.bestBid&&!e.bestAsk){$toast.error("Waiting For Orderbook...");return}const T=parseFloat(e.currencyBalance),F=parseFloat(e.pairBalance);if(M.value===0&&(M.value=w.value),t.orderType==="buy"){R.value=parseFloat(F*k/100).toFixed(x.value);const N=R.value/(1+t.fee/100);C.value=parseFloat(N/(t.formType==="market"?w.value:M.value)).toFixed(x.value)}else{C.value=parseFloat(T*k/100).toFixed(x.value);const N=C.value*l.value*(t.formType==="market"?w.value:M.value);R.value=parseFloat(N*(1-t.fee/100)).toFixed(x.value)}D()},D=()=>{let k,T;if(t.orderType==="buy"?T=t.pair:T=t.currency,k=e.pairBalance,k===null)return;if(t.formType==="market"&&e.bestBid===null){$toast.error("No spot price detected, Make a limit order first");return}const F=t.formType==="market"||M.value===0?w.value:M.value,N=C.value*l.value*F,V=Q(N);if(k<V){$toast.error(`Order amount higher than your ${T} wallet balance with fees`);return}R.value=V.toFixed(8)},Q=k=>{const T=k*t.fee/100;return k+T},w=B(()=>e[t.orderType==="buy"?"bestAsk":"bestBid"]);return{marketStore:e,submitForm:J,buttonId:q,buttonColor:U,orderAvailability:E,buttonText:ee,calculatePercentage:re,calculateTotalAmount:H,calculateTotal:D,minAmount:d,maxAmount:y,precisionAmount:x,amount:C,total:R,price:M,getBestPrice:()=>{const k=t.orderType==="buy"?e.bestAsk||e.bestBid:e.bestBid||e.bestAsk;M.value=k,D()},leverage:_,minLeverage:i,maxLeverage:c,lotSize:l,provider:b,platform:f}}};function Ue(t,r,o,e,d,l){const i=p("PriceInput"),c=p("AmountInput"),m=p("TotalInput"),b=p("Leverage"),f=p("Button");return n(),u("form",{class:"space-y-5 text-center",onSubmit:r[4]||(r[4]=$((...y)=>e.submitForm&&e.submitForm(...y),["prevent"]))},[o.formType=="limit"?(n(),L(i,{key:0,modelValue:e.price,"onUpdate:modelValue":r[0]||(r[0]=y=>e.price=y),"order-type":o.orderType,"pair-name":o.pair,onGetBestPrice:e.getBestPrice},null,8,["modelValue","order-type","pair-name","onGetBestPrice"])):O("",!0),g(c,{modelValue:e.amount,"onUpdate:modelValue":r[1]||(r[1]=y=>e.amount=y),"order-type":o.orderType,"form-type":o.formType,"min-amount":e.minAmount,"max-amount":e.maxAmount,"precision-amount":e.precisionAmount,"currency-name":o.currency,type:"lot","lot-size":e.lotSize,onCalculateTotal:e.calculateTotal,onCalculatePercentage:e.calculatePercentage},null,8,["modelValue","order-type","form-type","min-amount","max-amount","precision-amount","currency-name","lot-size","onCalculateTotal","onCalculatePercentage"]),g(m,{modelValue:e.total,"onUpdate:modelValue":r[2]||(r[2]=y=>e.total=y),"taker-fee":o.fee,"maker-fee":o.fee,"order-type":o.orderType,disabled:!0,"pair-name":o.pair},null,8,["modelValue","taker-fee","maker-fee","order-type","pair-name"]),e.platform.futures&&e.platform.futures.leverage_range==="slider_leverage"?(n(),L(b,{key:1,minLeverage:e.minLeverage,maxLeverage:e.maxLeverage,modelValue:e.leverage,"onUpdate:modelValue":r[3]||(r[3]=y=>e.leverage=y),onCalculateTotal:e.calculateTotal},null,8,["minLeverage","maxLeverage","modelValue","onCalculateTotal"])):O("",!0),g(f,{id:e.buttonId,color:e.buttonColor,outline:"",size:"sm",class:P(["w-full",o.formType+"Type"]),loading:e.marketStore.loading,disabled:e.marketStore.loading||!e.orderAvailability},{default:h(()=>[S(s(e.buttonText),1)]),_:1},8,["id","color","class","loading","disabled"])],32)}const We=I(De,[["render",Ue]]),je={props:{maxLeverage:[Number,String]},data(){return{platform:plat}},computed:{warningText(){return`Please be aware that trading with leverage involves risks. If the price climbs/drops by around ${(1/parseFloat(this.platform.futures.leverage_range==="fixed_leverage"?this.platform.futures.fixed_leverage_amount:this.maxLeverage)*100).toFixed(2)}%, the estimated profit/loss will be 100%`}}},He={for:"leverage",class:"leverage-label"},Ke={class:"text-left"},Ge={class:"text-danger font-bold"},Ye={class:"alert alert-secondary",style:{"margin-bottom":"0"}},Xe={class:"text-yellow-500 text-xs",style:{margin:"-4px"}};function Je(t,r,o,e,d,l){return n(),u(z,null,[a("label",He,[a("span",Ke,[S(s(t.$t("Leverage"))+": ",1),a("span",Ge,"x"+s(d.platform.futures.leverage_range==="fixed_leverage"?d.platform.futures.fixed_leverage_amount:o.maxLeverage),1)])]),a("div",Ye,[a("div",Xe,s(l.warningText),1)])],64)}const Qe=I(je,[["render",Je]]);const Ze={components:{OrderForm:We,Button:X,OneLeverage:Qe},props:{fee:{type:[Number,String],default:0},pfee:{type:[Number,String],default:0}},emits:["OrderPlaced"],async setup(){const t=ue(),r=j(),o=_e(),e=oe(),d=e.params.symbol,l=e.params.currency,i=window.plat;return r.futures.length===0&&await r.fetch_futures(),r.futures[l]&&r.futures[l][d+"/"+l+":"+l]&&(r.future=r.futures[l][d+"/"+l+":"+l]),{marketStore:r,walletsStore:o,userStore:t,currency:d,pair:l,platform:i}},data(){return{activeItem:"spot",loading:!1,provider,leverage:null}},created(){this.marketStore.fetchWallet(this.pair,2,"futures")},methods:{isActive(t){return this.activeItem===t},setActive(t){this.activeItem=t},setLeverage(t){this.leverage=t}}},et={class:"Order border border-gray-100 bg-white shadow dark:border-gray-700 dark:bg-gray-900"},tt={class:"w-full bg-gray-200 dark:bg-gray-800"},rt={id:"myTab",class:"nf flex-cols -mb-px flex overflow-x-hidden text-center",role:"tablist"},at={role:"presentation"},ot=["aria-selected"],st={role:"presentation"},nt=["aria-selected"],it={role:"presentation"},lt=["aria-selected"],ct={id:"myTabContent",class:"px-3 py-3"},dt={class:"grid grid-cols-2 gap-5 mb-4"},ut={class:"grid grid-cols-2 gap-5 mb-4"},mt={class:"grid grid-cols-2 gap-5"},gt={for:"basic-url",class:"border-1 order-label peer"},yt={class:"text-dark"},ft={key:1,class:"flex"},vt=["value"],bt={class:"order-span-2"};function pt(t,r,o,e,d,l){const i=p("order-form"),c=p("OneLeverage"),m=p("Button");return n(),u("div",et,[a("div",tt,[a("ul",rt,[a("li",at,[a("button",{id:"spot-tab",class:P(["inline-block py-2 pl-3 pr-4 text-xs font-medium",l.isActive("spot")?"active-tab":"inactive-tab"]),type:"button",role:"tab","aria-controls":"spot","aria-selected":!!l.isActive("spot"),onClick:r[0]||(r[0]=b=>l.setActive("spot"))},s(t.$t("Market")),11,ot)]),a("li",st,[a("button",{id:"limit-tab",class:P(["inline-block py-2 pl-3 pr-4 text-xs font-medium",l.isActive("limit")?"active-tab":"inactive-tab"]),type:"button",role:"tab","aria-controls":"limit","aria-selected":!!l.isActive("limit"),onClick:r[1]||(r[1]=b=>l.setActive("limit"))},s(t.$t("Limit")),11,nt)]),a("li",it,[a("button",{id:"wallets-tab",class:P(["inline-block py-2 pl-3 pr-4 text-xs font-medium",l.isActive("wallets")?"active-tab":"inactive-tab"]),type:"button",role:"tab","aria-controls":"wallets","aria-selected":!!l.isActive("wallets"),onClick:r[2]||(r[2]=b=>l.setActive("wallets"))},s(t.$t("Assets")),11,lt)])])]),a("div",ct,[a("div",{id:"spot",class:P({hidden:!l.isActive("spot")}),role:"tabpanel","aria-labelledby":"spot-tab"},[a("div",dt,[g(i,{"order-type":"buy","form-type":"market",fee:o.fee,pfee:o.pfee,store:e.marketStore,currency:e.currency,pair:e.pair,onOrderPlaced:r[3]||(r[3]=b=>t.$emit("OrderPlaced")),onLeverage:l.setLeverage},null,8,["fee","pfee","store","currency","pair","onLeverage"]),g(i,{"order-type":"sell","form-type":"market",fee:o.fee,pfee:o.pfee,store:e.marketStore,currency:e.currency,pair:e.pair,onOrderPlaced:r[4]||(r[4]=b=>t.$emit("OrderPlaced"))},null,8,["fee","pfee","store","currency","pair"])]),d.leverage!==null&&(e.platform.futures&&e.platform.futures.leverage_range==="largest_leverage"||e.platform.futures&&e.platform.futures.leverage_range==="fixed_leverage")?(n(),L(c,{key:0,maxLeverage:d.leverage},null,8,["maxLeverage"])):O("",!0)],2),a("div",{id:"limit",class:P({hidden:!l.isActive("limit")}),role:"tabpanel","aria-labelledby":"limit-tab"},[a("div",ut,[g(i,{"order-type":"buy","form-type":"limit",fee:o.fee,pfee:o.pfee,store:e.marketStore,currency:e.currency,pair:e.pair,onOrderPlaced:r[5]||(r[5]=b=>t.$emit("OrderPlaced"))},null,8,["fee","pfee","store","currency","pair"]),g(i,{"order-type":"sell","form-type":"limit",fee:o.fee,pfee:o.pfee,store:e.marketStore,currency:e.currency,pair:e.pair,onOrderPlaced:r[6]||(r[6]=b=>t.$emit("OrderPlaced"))},null,8,["fee","pfee","store","currency","pair"])]),d.leverage!==null&&(e.platform.futures&&e.platform.futures.leverage_range==="largest_leverage"||e.platform.futures&&e.platform.futures.leverage_range==="fixed_leverage")?(n(),L(c,{key:0,maxLeverage:d.leverage},null,8,["maxLeverage"])):O("",!0)],2),a("div",{id:"wallets",class:P({hidden:!l.isActive("wallets")}),role:"tabpanel","aria-labelledby":"wallets-tab"},[a("div",mt,[(n(),u("div",{key:"cur"+e.marketStore.pairBalance},[a("label",gt,[a("a",yt,s(e.pair)+" "+s(t.$t("Futures Wallet")),1)]),e.marketStore.pairBalance==null?(n(),u("form",{key:0,onSubmit:r[7]||(r[7]=$(b=>e.marketStore.createWallet(e.pair,2,"futures"),["prevent"]))},[g(m,{color:"green",outline:"",size:"sm",loading:d.loading,disabled:d.loading},{default:h(()=>[S(s(t.$t("Create Wallet")),1)]),_:1},8,["loading","disabled"])],32)):(n(),u("div",ft,[(n(),u("input",{key:e.marketStore.pairBalance,type:"number",class:"order-input",value:e.marketStore.pairBalance,readonly:"","aria-label":"Amount (to the nearest dollar)"},null,8,vt)),a("span",bt,s(e.pair),1)]))]))])],2)])])}const _t=I(Ze,[["render",pt],["__scopeId","data-v-126c0822"]]),ht={name:"CancelPosition",components:{Modal:de,Button:X},props:{currency:{type:String,required:!0},pair:{type:String,required:!0},lots:{type:[Number,String],required:!0},type:{type:String,required:!0},side:{type:String,required:!0}},emits:["positionClosed"],setup(t,{emit:r}){const o=j(),e=v(null),d=v(null),l=v(null),i=v(!1),c=B(()=>o[t.side==="long"?"bestBid":"bestAsk"]);return{marketStore:o,amount:e,price:d,percentage:l,closePosition:async()=>{i.value=!0;const f="/user/futures/position/sell",y={id:o.future.id,symbol:t.currency,currency:t.pair,amount:e.value,price:t.type==="limit"?d.value:c.value,type:t.type};try{const _=await axios.post(f,y);$toast.success(_.message)}catch(_){$toast.success(_.response.data.message)}finally{i.value=!1,o.closeModal("closePositionMarket"),r("positionClosed"),o.fetchWallet(t.pair,2,"futures")}},setPercentage:f=>{e.value=Math.floor(f/100*t.lots),l.value=f},loading:i}}},kt={class:"flex items-center text-lg"},xt={style:{margin:"-24px !important"}},Pt={class:"space-y-3 p-5"},wt={key:0},St={for:"price"},Lt=["placeholder","step"],Tt={for:"amount"},At=["max","placeholder"],Ct={class:"flex space-x-3 w-full"},Ot=["disabled"],Mt=["disabled"],Bt=["disabled"],Ft={key:1},$t={class:"modal-footer mt-5"};function It(t,r,o,e,d,l){const i=p("Button"),c=p("Modal");return n(),L(me,{name:"modal",mode:"out-in","enter-active-class":"modal-enter-active","leave-active-class":"modal-leave-active"},{default:h(()=>[e.marketStore.isShowModal.closePositionMarket?(n(),L(c,{key:0,size:"lg",onClose:r[7]||(r[7]=m=>e.marketStore.closeModal("closePositionMarket"))},{header:h(()=>[a("div",kt,s(o.type==="market"?t.$t("Close with Market Order"):t.$t("Close with Limit Order")),1)]),body:h(()=>[a("div",xt,[a("form",{onSubmit:r[6]||(r[6]=$((...m)=>e.closePosition&&e.closePosition(...m),["prevent"]))},[a("div",Pt,[o.type==="limit"?(n(),u("div",wt,[a("label",St,s(t.$t("Price"))+" ("+s(t.$route.params.currency)+")",1),A(a("input",{"onUpdate:modelValue":r[0]||(r[0]=m=>e.price=m),type:"number",required:"",class:"form-control",placeholder:"Must be a multiple of "+e.marketStore.future.limits.price.min,step:e.marketStore.future.limits.price.min},null,8,Lt),[[Y,e.price]])])):O("",!0),a("div",null,[a("label",Tt,s(t.$t("Amount (lot)")),1),A(a("input",{"onUpdate:modelValue":r[1]||(r[1]=m=>e.amount=m),type:"number",required:"",class:"form-control",min:1,max:o.lots,step:"1",placeholder:"1 Lot = "+e.marketStore.future.contractSize+" "+t.$route.params.symbol},null,8,At),[[Y,e.amount]])]),a("div",null,[a("div",Ct,[a("button",{type:"button",class:P(["btn btn-sm w-full",e.percentage===25?"btn-outline-success":"btn-outline-secondary"]),onClick:r[2]||(r[2]=m=>e.setPercentage(25)),disabled:o.lots<2}," 25% ",10,Ot),a("button",{type:"button",class:P(["btn btn-sm w-full",e.percentage===50?"btn-outline-success":"btn-outline-secondary"]),onClick:r[3]||(r[3]=m=>e.setPercentage(50)),disabled:o.lots<2}," 50% ",10,Mt),a("button",{type:"button",class:P(["btn btn-sm w-full",e.percentage===75?"btn-outline-success":"btn-outline-secondary"]),onClick:r[4]||(r[4]=m=>e.setPercentage(75)),disabled:o.lots<2}," 75% ",10,Bt),a("button",{type:"button",class:P(["btn btn-sm w-full",e.percentage===100?"btn-outline-success":"btn-outline-secondary"]),onClick:r[5]||(r[5]=m=>e.setPercentage(100))}," 100% ",2)])]),e.amount&&e.amount>0&&o.type==="market"?(n(),u("div",Ft,[a("p",null,s(t.$t("Your position of"))+" "+s(e.amount)+" "+s(t.$t("lot(s) will be closed at the market price.")),1)])):O("",!0)]),a("div",$t,[g(i,{type:"submit",color:"green",outline:"",class:"w-full flex justify-center items-center",loading:e.loading,disabled:e.loading},{default:h(()=>[S(s(t.$t("Confirm")),1)]),_:1},8,["loading","disabled"])])],32)])]),_:1})):O("",!0)]),_:1})}const qt=I(ht,[["render",It]]),Nt={name:"AddTakeProfitStopLoss",components:{Modal:de},emits:["added"],props:{currency:{type:String,required:!0},pair:{type:String,required:!0},position:{type:Object,required:!0}},setup(t,{emit:r}){const o=j(),e=v(null),d=v(null),l=v(null),i=v(null),c=B(()=>o.bestAsk),m=[25,50,75,100,125,150,175,200],b=[5,15,25,50,75];Z([e,d],()=>{_(),x()});const f=v(!1),y=v(!1),_=()=>{f.value=e.value>=position.entryPrice&&e.value<=c.value},x=()=>{y.value=d.value>=position.liquidationPrice&&d.value<=position.entryPrice};return{marketStore:o,takeProfit:e,stopLoss:d,takeProfitPercentage:l,stopLossPercentage:i,marketPrice:c,takeProfitPercentages:m,stopLossPercentages:b,addTakeProfitStopLoss:async()=>{const q="/user/futures/position/add-take-profit-stop-loss",U={id:o.future.id,currency:t.currency,pair:t.pair,takeProfit:e.value,stopLoss:d.value};try{const E=await axios.post(q,U);$toast.success(E.message)}catch(E){$toast.success(E.response.data.message)}finally{o.closeModal("takeProfitStopLoss"),r("added")}},setTakeProfitPercentage:q=>{l.value=q,e.value=Number((100+q)/100*c.value).toFixed(6)},setStopLossPercentage:q=>{i.value=q,d.value=Number(q/100*c.value).toFixed(6)},isTakeProfitValid:f,isStopLossValid:y}}},Vt={class:"flex items-center text-lg"},zt={style:{margin:"-24px !important"}},Rt={class:"space-y-3 p-5"},Et={class:"mb-3 flex justify-between"},Dt={class:"mb-3 flex justify-between"},Ut={class:"mb-3"},Wt={for:"takeProfit"},jt=["min","max"],Ht={class:"flex space-x-3 w-full"},Kt=["onClick"],Gt={class:"mt-2"},Yt={class:"mt-4"},Xt={for:"stopLoss"},Jt=["min","max"],Qt={class:"flex space-x-3 w-full"},Zt=["onClick"],er={class:"modal-footer mt-5"},tr={class:"flex justify-end"},rr=["disabled"];function ar(t,r,o,e,d,l){const i=p("Modal");return n(),L(me,{name:"modal",mode:"out-in","enter-active-class":"modal-enter-active","leave-active-class":"modal-leave-active"},{default:h(()=>[e.marketStore.isShowModal.takeProfitStopLoss?(n(),L(i,{key:0,size:"lg",onClose:r[4]||(r[4]=c=>e.marketStore.closeModal("takeProfitStopLoss"))},{header:h(()=>[a("div",Vt,s(t.$t("Add Take Profit & Stop Loss")),1)]),body:h(()=>[a("div",zt,[a("form",{onSubmit:r[3]||(r[3]=$((...c)=>e.addTakeProfitStopLoss&&e.addTakeProfitStopLoss(...c),["prevent"]))},[a("div",Rt,[a("div",Et,[a("span",null,s(t.$t("Entry Price"))+" ("+s(t.$route.params.currency)+") ",1),a("span",null,s(o.position.entryPrice),1)]),a("div",Dt,[a("span",null,s(t.$t("Liquidation Price"))+" ("+s(t.$route.params.currency)+") ",1),a("span",null,s(o.position.liquidationPrice),1)]),a("div",Ut,[a("label",Wt,s(t.$t("Take Profit")),1),A(a("input",{"onUpdate:modelValue":r[0]||(r[0]=c=>e.takeProfit=c),type:"number",required:"",class:"form-control",min:o.position.entryPrice,max:e.marketPrice,step:"0.01"},null,8,jt),[[Y,e.takeProfit]])]),a("div",null,[a("div",Ht,[(n(!0),u(z,null,W(e.takeProfitPercentages,c=>(n(),u("button",{key:c,type:"button",class:P(["btn btn-sm w-full",c===e.takeProfitPercentage?"btn-outline-success":"btn-outline-secondary"]),onClick:m=>e.setTakeProfitPercentage(c)},s(c)+"% ",11,Kt))),128))]),a("p",Gt,s(t.$t("If the Market Price climbs to the take profit price, the take profit market order will be triggered.")),1)]),a("div",Yt,[a("label",Xt,s(t.$t("Stop Loss")),1),A(a("input",{"onUpdate:modelValue":r[1]||(r[1]=c=>e.stopLoss=c),type:"number",required:"",class:"form-control",min:o.position.liquidationPrice,max:o.position.entryPrice,step:"0.01"},null,8,Jt),[[Y,e.stopLoss]])]),a("div",null,[a("div",Qt,[(n(!0),u(z,null,W(e.stopLossPercentages,c=>(n(),u("button",{key:c,type:"button",class:P(["btn btn-sm w-full",c===e.stopLossPercentage?"btn-outline-success":"btn-outline-secondary"]),onClick:m=>e.setStopLossPercentage(c)},s(c)+"% ",11,Zt))),128))])])]),a("div",er,[a("div",tr,[a("button",{type:"submit",class:"btn btn-outline-success mr-3",disabled:e.marketStore.loading||!e.isTakeProfitValid||!e.isStopLossValid},s(t.$t("Confirm")),9,rr),a("button",{type:"button",class:"btn btn-outline-secondary",onClick:r[2]||(r[2]=c=>e.marketStore.closeModal("takeProfitStopLoss"))},s(t.$t("Close")),1)])])],32)])]),_:1})):O("",!0)]),_:1})}const or=I(Nt,[["render",ar]]),sr={name:"OpenOrdersTable",components:{Col:ge,Button:X,toMoney:ne,toDate:ie},props:{items:{type:Array,required:!0},marketStore:{type:Object,required:!0},currency:{type:String,required:!0},symbol:{type:String,required:!0}},emits:["refreshed"],setup(t,{emit:r}){const o=v(1),e=v(0),d=v(null),l=v(!1),i=async()=>{await axios.post("/user/futures/order/refresh",{id:t.marketStore.future.id,currency:t.currency,symbol:t.symbol}).then(f=>{f.success===!0&&r("refreshed")}).catch(f=>{$toast.error(f.response.data.message)})},c=async f=>{l.value=!0,await axios.post("/user/futures/order/cancel",{id:t.marketStore.future.id,order_id:f,currency:t.currency}).then(y=>{$toast.success(y.message),r("refreshed")}).catch(y=>{$toast.error(y.response.data.message)}).finally(()=>{l.value=!1})},m=()=>{d.value=setInterval(i,5e3)},b=()=>{clearInterval(d.value)};return se(()=>{m()}),ke(()=>{b()}),{currentPage:o,totalPages:e,cancelOrder:c,loading:l}}},nr={class:"overflow-x-auto"},ir={class:"bg-gray-100 text-xs uppercase text-gray-700 dark:bg-gray-700 dark:text-gray-400"},lr={scope:"col",class:"p-1"},cr={"data-label":"Time",class:"p-2"},dr={"data-label":"Type",class:"text-uppercase"},ur={key:0,class:"badge bg-success"},mr={key:1,class:"badge bg-danger"},gr={"data-label":"Side",class:"text-uppercase"},yr={key:0,class:"badge bg-success"},fr={key:1,class:"badge bg-danger"},vr={"data-label":"Price"},br={"data-label":"Amount",class:"text-success"},pr={"data-label":"Filled"},_r={"data-label":"Value"},hr={"data-label":"Take Profit & Stop Loss"},kr={class:"text-success"},xr={class:"text-danger"},Pr={"data-label":"Cancel"},wr=a("i",{class:"bi bi-x-lg",style:{"margin-right":"0 !important"}},null,-1);function Sr(t,r,o,e,d,l){const i=p("Col"),c=p("VTh"),m=p("to-date"),b=p("Button"),f=p("VTable");return n(),u("div",nr,[g(f,{"current-page":e.currentPage,"onUpdate:currentPage":r[0]||(r[0]=y=>e.currentPage=y),class:"w-full text-left text-gray-500 dark:text-gray-400",data:o.items,"page-size":10,"hide-sort-icons":!0,onTotalPagesChanged:r[1]||(r[1]=y=>e.totalPages=y)},{head:h(()=>[a("tr",ir,[g(c,{"sort-key":"time",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Time"})]),_:1}),g(c,{"sort-key":"type",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Type"})]),_:1}),g(c,{"sort-key":"side",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Side"})]),_:1}),g(c,{"sort-key":"price",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Price"})]),_:1}),g(c,{"sort-key":"amount",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Amount"})]),_:1}),g(c,{"sort-key":"filled",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Filled"})]),_:1}),g(c,{"sort-key":"value",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Value"})]),_:1}),a("th",lr,s(t.$t("Take Profit & Stop Loss")),1),g(c,{"sort-key":"cancel",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Cancel"})]),_:1})])]),body:h(({rows:y})=>[(n(!0),u(z,null,W(y,_=>(n(),u("tr",{key:_.id,class:"border-b bg-white dark:border-gray-700 dark:bg-gray-800"},[a("td",cr,[g(m,{time:_.created_at,full:!0},null,8,["time"])]),a("td",dr,[_.type=="limit"?(n(),u("span",ur,s(t.$t("Limit")),1)):(n(),u("span",mr,s(t.$t("Market")),1))]),a("td",gr,[_.side=="buy"?(n(),u("span",yr,s(t.$t("Long")),1)):(n(),u("span",fr,s(t.$t("Short")),1))]),a("td",vr,s(_.price),1),a("td",br,s(_.amount)+" Lot",1),a("td",pr,s(_.filled),1),a("td",_r,s(_.price*_.amount),1),a("td",hr,[a("div",kr,s(_.takeProfit||"-"),1),a("div",xr,s(_.stopLoss||"-"),1)]),a("td",Pr,[_.status=="open"?(n(),L(b,{key:0,size:"xs",color:"light",onClick:x=>e.cancelOrder(_.order_id),disabled:e.loading,loading:e.loading},{default:h(()=>[wr]),_:2},1032,["onClick","disabled","loading"])):O("",!0)])]))),128))]),_:1},8,["current-page","data"])])}const Lr=I(sr,[["render",Sr]]),Tr={components:{Button:X,toMoney:ne,toDate:ie},props:{position:{type:Object,default:null},marketStore:{type:Object,required:!0}},emits:["liquidation"],setup(t,{emit:r}){const o=v(!1),e=i=>{t.marketStore.closePositionType=i,t.marketStore.showModal("closePositionMarket")},d=B(()=>{if(t.position&&t.marketStore.bestAsk!==void 0){const i=parseFloat(t.position.entryPrice),c=parseFloat(t.marketStore.bestAsk),m=parseFloat(t.position.leverage),b=parseFloat(t.position.contracts),f=(c-i)*b*m,y=f/(i*b)*100;return y<-90?r("liquidation",!0):r("liquidation",!1),{pnl:f.toFixed(8),percentage:y.toFixed(2)}}return null}),l=B(()=>{if(t.position&&t.marketStore.bestAsk!==void 0){const i=parseFloat(t.marketStore.bestAsk),c=parseFloat(t.position.liquidationPrice),m=parseFloat(t.position.leverage),b=Math.abs(i-c),f=m*b,y={"text-danger":f<=.1,"text-warning":f>.1&&f<=.5,"text-normal":f>.5};return Object.keys(y).find(x=>y[x])||""}return""});return{loading:o,closePosition:e,unrealizedPnl:d,liquidationPriceClass:l}}},Ar={key:0},Cr={class:"text-lg font-semibold mb-2"},Or={class:"flex flex-wrap gap-3"},Mr={class:"flex-1 shadow p-2 bg-white dark:bg-gray-800 rounded"},Br={class:"text-sm text-gray-600 dark:text-gray-400"},Fr={class:"text-lg"},$r={class:"flex-1 shadow p-2 bg-white dark:bg-gray-800 rounded"},Ir={class:"text-sm text-gray-600 dark:text-gray-400"},qr={class:"text-lg"},Nr={class:"flex-1 shadow p-2 bg-white dark:bg-gray-800 rounded"},Vr={class:"text-sm text-gray-600 dark:text-gray-400"},zr={class:"text-lg"},Rr={class:"flex-1 shadow p-2 bg-white dark:bg-gray-800 rounded"},Er={class:"text-sm text-gray-600 dark:text-gray-400"},Dr={key:1},Ur={class:"flex flex-wrap gap-3 mt-3"},Wr={class:"flex-1 shadow p-2 bg-white dark:bg-gray-800 rounded"},jr={class:"text-sm text-gray-600 dark:text-gray-400"},Hr={class:"flex-1 shadow p-2 bg-white dark:bg-gray-800 rounded"},Kr={class:"text-sm text-gray-600 dark:text-gray-400"},Gr={class:"text-lg"},Yr={class:"flex-1 shadow p-2 bg-white dark:bg-gray-800 rounded"},Xr={class:"text-sm text-gray-600 dark:text-gray-400"},Jr={class:"text-lg"},Qr={class:"text-xs ml-1"},Zr={key:1},ea={class:"flex-1 shadow p-2 bg-white dark:bg-gray-800 rounded"},ta={class:"text-sm text-gray-600 dark:text-gray-400"},ra={class:"text-lg text-success"},aa={class:"flex flex-wrap gap-3 mt-3"},oa={class:"flex-1 shadow p-2 bg-white dark:bg-gray-800 rounded"},sa={class:"text-sm text-gray-600 dark:text-gray-400"},na={class:"text-lg"},ia={class:"flex-1 shadow p-2 bg-white dark:bg-gray-800 rounded"},la={class:"text-sm text-gray-600 dark:text-gray-400"},ca={class:"text-lg"},da={class:"flex-1 shadow p-2 bg-white dark:bg-gray-800 rounded"},ua={class:"text-sm text-gray-600 dark:text-gray-400"},ma={class:"text-lg"},ga={class:"flex-1 shadow p-2 bg-white dark:bg-gray-800 rounded"},ya={class:"text-sm text-gray-600 dark:text-gray-400"},fa={key:0,class:"space-x-2"},va={key:0,class:"bi bi-x",style:{"margin-right":"0 !important"}},ba={key:0,class:"bi bi-x",style:{"margin-right":"0 !important"}},pa={key:1};function _a(t,r,o,e,d,l){const i=p("to-date"),c=p("Button"),m=xe("tooltip");return o.position!==null?(n(),u("div",Ar,[a("div",Cr,s(o.position.symbol),1),a("div",Or,[a("div",Mr,[A((n(),u("div",Br,[S(s(t.$t("Initial Margin")),1)])),[[m,"The initial margin required for this position"]]),a("div",Fr,s(o.position.initialMargin),1)]),a("div",$r,[A((n(),u("div",Ir,[S(s(t.$t("Maintenance Margin")),1)])),[[m,"The maintenance margin required for this position"]]),a("div",qr,s(o.position.maintenanceMargin),1)]),a("div",Nr,[A((n(),u("div",Vr,[S(s(t.$t("Entry Price")),1)])),[[m,"The average entry price of the current position."]]),a("div",zr,s(o.position.entryPrice),1)]),a("div",Rr,[A((n(),u("div",Er,[S(s(t.$t("Mark Price")),1)])),[[m,"The latest mark price of this contract, used for Unrealized PNL calculation. If the mark price reaches the liquidation price, the position will be liquidated."]]),o.marketStore.bestAsk!==null?(n(),u("div",{key:0,class:P(["text-lg",o.marketStore.bestAsk>o.position.entryPrice?"text-success":"text-danger"])},s(o.marketStore.bestAsk),3)):(n(),u("div",Dr,"-"))])]),a("div",Ur,[a("div",Wr,[A((n(),u("div",jr,[S(s(t.$t("Liquidation Price")),1)])),[[m,"If the mark price of the contract falls below this price (when long) or rises above this price (when short), your position will be liquidated."]]),a("div",{class:P(e.liquidationPriceClass)},s(o.position.liquidationPrice),3)]),a("div",Hr,[A((n(),u("div",Kr,[S(s(t.$t("Leverage")),1)])),[[m,"The leverage used for this position"]]),a("div",Gr,"x"+s(o.position.leverage),1)]),a("div",Yr,[A((n(),u("div",Xr,[S(s(t.$t("Unrealized PNL (ROE)")),1)])),[[m,"The unrealized profit and loss and the return on equity calculated based on the mark price of the position."]]),o.marketStore.bestAsk!==null?(n(),u("div",{key:0,class:P([e.unrealizedPnl&&e.unrealizedPnl.pnl>0?"text-success":"text-danger","flex items-center"])},[a("span",Jr,s(e.unrealizedPnl?e.unrealizedPnl.pnl+" "+t.$route.params.currency:"-"),1),A((n(),u("span",Qr,[S("("+s(e.unrealizedPnl?e.unrealizedPnl.percentage+"%":"-")+")",1)])),[[m,e.unrealizedPnl?"Percentage: "+e.unrealizedPnl.percentage+"%":"-"]])],2)):(n(),u("div",Zr,"-"))]),a("div",ea,[A((n(),u("div",ta,[S(s(t.$t("Amount")),1)])),[[m,"Your current position on the platform. If positive, you are long. If negative, you are short."]]),a("div",ra,s(o.position.contracts)+" lot",1)])]),a("div",aa,[a("div",oa,[A((n(),u("div",sa,[S(s(t.$t("Date")),1)])),[[m,"The date and time when the position was opened"]]),a("div",na,[o.position.created_at!==void 0?(n(),L(i,{key:0,time:o.position.created_at,full:!0},null,8,["time"])):O("",!0)])]),a("div",ia,[A((n(),u("div",la,[S(s(t.$t("Contracts")),1)])),[[m,"The number of contracts in the position"]]),a("div",ca,s(o.position.contracts),1)]),a("div",da,[A((n(),u("div",ua,[S(s(t.$t("Take Profit / Stop Loss")),1)])),[[m,"The take profit and stop loss levels for the position"]]),a("div",ma,s(o.position.takeProfit||"-")+" / "+s(o.position.stopLoss||"-"),1)]),a("div",ga,[A((n(),u("div",ya,[S(s(t.$t("Close Position")),1)])),[[m,"The take profit and stop loss levels for the position"]]),o.marketStore.bestAsk!==null?(n(),u("div",fa,[g(c,{size:"xs",color:"light",loading:e.loading,disabled:e.loading,onClick:r[0]||(r[0]=b=>e.closePosition("market"))},{default:h(()=>[e.loading?O("",!0):(n(),u("i",va)),S(" "+s(t.$t("Market")),1)]),_:1},8,["loading","disabled"]),g(c,{size:"xs",color:"light",loading:e.loading,disabled:e.loading,onClick:r[1]||(r[1]=b=>e.closePosition("limit"))},{default:h(()=>[e.loading?O("",!0):(n(),u("i",ba)),S(" "+s(t.$t("Limit")),1)]),_:1},8,["loading","disabled"])])):(n(),u("div",pa,"-"))])])])):O("",!0)}const ha=I(Tr,[["render",_a]]),ka={components:{Col:ge,toMoney:ne,toDate:ie},props:{orders:{type:Array,default:()=>[]},PrecisionPrice:{type:Number,default:2},PrecisionAmount:{type:Number,default:2},currency:{type:String,default:""}},setup(t){const r=v(1),o=v(1);return{currentPage:r,totalPages:o}}},xa={class:"overflow-x-auto"},Pa={class:"bg-gray-100 text-xs uppercase text-gray-700 dark:bg-gray-700 dark:text-gray-400"},wa={class:"p-1","data-label":"Date"},Sa={"data-label":"Symbol",class:"text-uppercase"},La={"data-label":"Side",class:"text-uppercase"},Ta={key:0,class:"badge bg-success"},Aa={key:1,class:"badge bg-danger"},Ca={"data-label":"Price"},Oa={"data-label":"Amount"},Ma={"data-label":"Filled"},Ba={"data-label":"Status"},Fa={key:0,class:"badge bg-success"},$a={key:1,class:"badge bg-primary"},Ia={key:2,class:"badge bg-danger"},qa={class:"sr-only"},Na=a("svg",{class:"h-5 w-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[a("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1),Va={class:"sr-only"},za=a("svg",{class:"h-5 w-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[a("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1);function Ra(t,r,o,e,d,l){const i=p("Col"),c=p("VTh"),m=p("to-date"),b=p("to-money"),f=p("VTable"),y=p("VTPagination");return n(),u(z,null,[a("div",xa,[g(f,{"current-page":e.currentPage,"onUpdate:currentPage":r[0]||(r[0]=_=>e.currentPage=_),class:"w-full text-left text-gray-500 dark:text-gray-400",data:o.orders,"page-size":10,"hide-sort-icons":!0,onTotalPagesChanged:r[1]||(r[1]=_=>e.totalPages=_)},{head:h(()=>[a("tr",Pa,[g(c,{"sort-key":"created_at",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Date"})]),_:1}),g(c,{"sort-key":"symbol",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Symbol"})]),_:1}),g(c,{"sort-key":"side",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Side"})]),_:1}),g(c,{"sort-key":"price",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Price"})]),_:1}),g(c,{"sort-key":"amount",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Amount"})]),_:1}),g(c,{"sort-key":"filled",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Filled"})]),_:1}),g(c,{"sort-key":"status",scope:"col",class:"p-1"},{default:h(()=>[g(i,{text:"Status"})]),_:1})])]),body:h(({rows:_})=>[(n(!0),u(z,null,W(_,x=>(n(),u("tr",{key:x.id,class:"border-b bg-white dark:border-gray-700 dark:bg-gray-800"},[a("td",wa,[g(m,{time:x.created_at,full:!0},null,8,["time"])]),a("td",Sa,s(x.symbol),1),a("td",La,[x.side=="buy"?(n(),u("span",Ta,s(t.$t("Long")),1)):(n(),u("span",Aa,s(t.$t("Short")),1))]),a("td",Ca,[g(b,{num:x.price,decimals:o.PrecisionPrice},null,8,["num","decimals"]),S(" "+s(x.pair),1)]),a("td",Oa,[g(b,{num:x.amount,decimals:o.PrecisionAmount},null,8,["num","decimals"]),S(" "+s(o.currency),1)]),a("td",Ma,[g(b,{num:x.filled,decimals:o.PrecisionAmount},null,8,["num","decimals"]),S(" "+s(o.currency),1)]),a("td",Ba,[x.status=="closed"?(n(),u("span",Fa,s(t.$t("Filled")),1)):x.status=="open"?(n(),u("span",$a,s(t.$t("Live")),1)):(n(),u("span",Ia,s(t.$t("Canceled")),1))])]))),128))]),_:1},8,["current-page","data"])]),g(y,{currentPage:e.currentPage,"onUpdate:currentPage":r[2]||(r[2]=_=>e.currentPage=_),class:"flex items-center justify-between p-3","aria-label":"Table navigation","total-pages":e.totalPages,"max-page-links":3,"boundary-links":!0},{firstPage:h(()=>[S(s(t.$t("First")),1)]),lastPage:h(()=>[S(s(t.$t("Last")),1)]),next:h(()=>[a("span",qa,s(t.$t("Next")),1),Na]),previous:h(()=>[a("span",Va,s(t.$t("Previous")),1),za]),_:1},8,["currentPage","total-pages"])],64)}const Ea=I(ka,[["render",Ra]]),Da={components:{CancelPosition:qt,TakeProfitStopLoss:or,OpenOrders:Lr,PositionDetails:ha,OrdersHistory:Ea},setup(){const t=j(),r=oe(),o=r.params.symbol,e=r.params.currency,d=v("position"),l=v(1),i=v(0),c=v(1),m=v(0),b=v(!1),f=v(!1),y=v([]),_=v([]),x=v([]),C=async()=>{await axios.get("/user/futures/order/"+o+"/"+e).then(w=>{_.value=w.position,x.value=w.openOrders,y.value=w.orders})},R=async()=>{await axios.get("/user/futures/position/"+o+"/"+e).then(w=>{_.value=w.position})},M=B(()=>t.future?U(t.future.precision.amount||1e-6):6),q=B(()=>t.future?U(t.future.precision.price||1e-6):6),U=w=>{if(Math.floor(w)===w)return 0;const K=w.toString(),k=/^(\d+\.?\d*|\.\d+)e([\+\-]\d+)$/.exec(K);if(k){const F=(k[1].split(".")[1]||"").length+parseInt(k[2]);return Math.min(Math.max(F,0),20)}else{const T=K.split(".")[1]||"";return Math.min(Math.max(T.length,0),20)}},E=async w=>{b.value=!0;try{await axios.post("/user/futures/order/cancel",{order_id:w}),C(),t.fetchWallet(e,2,"futures")}catch(K){console.error(K)}finally{b.value=!1}},ee=w=>d.value===w,te=w=>{d.value=w},J=v(null),H=v(!1),re=async w=>{w?D():Q()},D=()=>{H.value||(J.value=setInterval(R,2e3),H.value=!0)},Q=()=>{clearInterval(J.value),H.value=!1};return se(()=>{C(),R()}),Pe(()=>{Q()}),{marketStore:t,PrecisionAmount:M,PrecisionPrice:q,currency:o,pair:e,activeItem:d,orders:y,position:_,currentPage:l,totalPages:i,currentPageposition:c,totalPagesposition:m,loading:b,refreshing:f,fetchOrders:C,cancelOrder:E,fetchOrders:C,isActive:ee,setActive:te,openOrders:x,handleLiquidate:re}}},Ua={class:"border border-gray-100 bg-white shadow dark:border-gray-700 dark:bg-gray-900",style:{margin:"0 -20px"}},Wa={id:"myTab",class:"nf flex-cols -mb-px flex overflow-x-hidden bg-gray-200 dark:bg-gray-800",role:"tablist"},ja={class:"overflow-x-auto px-4 pb-2"},Ha={key:1,class:"text-center flex justify-center items-center flex-col w-full"},Ka=a("img",{height:"128",width:"128",src:"/assets/empty.svg",alt:""},null,-1),Ga={class:"mt-4 text-gray-600 dark:text-gray-400"},Ya={key:1,class:"text-center flex justify-center items-center flex-col w-full"},Xa=a("img",{height:"128",width:"128",src:"/assets/empty.svg",alt:""},null,-1),Ja={class:"mt-4 text-gray-600 dark:text-gray-400"},Qa={key:1,class:"text-center flex justify-center items-center flex-col w-full"},Za=a("img",{height:"128",width:"128",src:"/assets/empty.svg",alt:""},null,-1),eo={class:"mt-4 text-gray-600 dark:text-gray-400"};function to(t,r,o,e,d,l){const i=p("PositionDetails"),c=p("OpenOrders"),m=p("OrdersHistory"),b=p("CancelPosition"),f=p("TakeProfitStopLoss");return n(),u(z,null,[a("div",Ua,[a("ul",Wa,[a("li",null,[a("a",{id:"position-tab",class:P(["inline-block py-2 pl-3 pr-4 text-xs font-medium",e.isActive("position")?"border-gray-300 bg-white text-gray-700 dark:bg-gray-900 dark:text-gray-300":"cursor-pointer border-transparent bg-gray-200 text-gray-400 hover:border-gray-300 hover:bg-gray-300 hover:text-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-gray-300"]),type:"button",role:"tab","aria-controls":"position","aria-selected":"false",onClick:r[0]||(r[0]=$(y=>e.setActive("position"),["prevent"]))},s(t.$t("Open Position")),3)]),a("li",null,[a("a",{id:"open-orders-tab",class:P(["inline-block py-2 pl-3 pr-4 text-xs font-medium",e.isActive("open-orders")?"border-gray-300 bg-white text-gray-700 dark:bg-gray-900 dark:text-gray-300":"cursor-pointer border-transparent bg-gray-200 text-gray-400 hover:border-gray-300 hover:bg-gray-300 hover:text-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-gray-300"]),type:"button",role:"tab","aria-controls":"open-orders","aria-selected":"false",onClick:r[1]||(r[1]=$(y=>e.setActive("open-orders"),["prevent"]))},s(t.$t("Open Orders")),3)]),a("li",null,[a("a",{id:"orders-tab",class:P(["inline-block py-2 pl-3 pr-4 text-xs font-medium",e.isActive("orders")?"border-gray-300 bg-white text-gray-700 dark:bg-gray-900 dark:text-gray-300":"cursor-pointer border-transparent bg-gray-200 text-gray-400 hover:border-gray-300 hover:bg-gray-300 hover:text-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-gray-300"]),type:"button",role:"tab","aria-controls":"orders","aria-selected":"false",onClick:r[2]||(r[2]=$(y=>e.setActive("orders"),["prevent"]))},s(t.$t("Order History")),3)])]),a("div",{id:"position",class:P(["pt-3",e.isActive("position")?"":"hidden"]),role:"tabpanel",style:{"min-height":"300px"}},[a("div",ja,[e.position!==null?(n(),L(i,{key:0,position:e.position,marketStore:e.marketStore,onLiquidation:e.handleLiquidate},null,8,["position","marketStore","onLiquidation"])):(n(),u("div",Ha,[Ka,a("div",Ga,s(t.$t("No Open Position Found")),1)]))])],2),a("div",{id:"open-orders",class:P(["pt-3",e.isActive("open-orders")?"":"hidden"]),role:"tabpanel",style:{"min-height":"300px"}},[e.openOrders.length>0?(n(),L(c,{key:0,items:e.openOrders,currency:t.$route.params.currency,symbol:t.$route.params.symbol,marketStore:e.marketStore,onRefreshed:e.fetchOrders},null,8,["items","currency","symbol","marketStore","onRefreshed"])):(n(),u("div",Ya,[Xa,a("div",Ja,s(t.$t("No Open Orders Found")),1)]))],2),a("div",{id:"orders",class:P(["pt-3",e.isActive("orders")?"":"hidden"]),role:"tabpanel",style:{"min-height":"300px"}},[e.orders.length>0?(n(),L(m,{key:0,orders:e.orders,PrecisionPrice:e.PrecisionPrice,PrecisionAmount:e.PrecisionAmount,currency:e.currency},null,8,["orders","PrecisionPrice","PrecisionAmount","currency"])):(n(),u("div",Qa,[Za,a("div",eo,s(t.$t("No Orders Found")),1)]))],2)]),e.position!==null&&e.marketStore.closePositionType!==null?(n(),L(b,{key:0,lots:e.position.contracts,pair:e.pair,currency:e.currency,type:e.marketStore.closePositionType,side:e.position.side,onPositionClosed:e.fetchOrders},null,8,["lots","pair","currency","type","side","onPositionClosed"])):O("",!0),e.position!==null?(n(),L(f,{key:1,position:e.position,currency:e.currency,pair:e.pair,onAdded:e.fetchOrders},null,8,["position","currency","pair","onAdded"])):O("",!0)],64)}const ro=I(Da,[["render",to]]);const ao={components:{Markets:ve,Trades:be,Marketinfo:pe,Tradingview:ce(()=>le(()=>import("./Tradingview-ce040f18.js"),["assets/Tradingview-ce040f18.js","assets/bootstrap-2a895a5a.js","assets/_commonjsHelpers-de833af9.js","assets/browser-77dd377d.js","assets/preload-helper-f61836a9.js","assets/axios-4a70c6fc.js","assets/bootstrap-fc0de13c.css"])),EcoTradingview:ce(()=>le(()=>import("./Tradingview-a40812b1.js"),["assets/Tradingview-a40812b1.js","assets/datafeed-d62ae98f.js","assets/_commonjsHelpers-de833af9.js","assets/market-b51fc72c.js","assets/bootstrap-2a895a5a.js","assets/browser-77dd377d.js","assets/preload-helper-f61836a9.js","assets/axios-4a70c6fc.js","assets/bootstrap-fc0de13c.css"])),Order:_t,Orders:ro,Orderbook:Ce},setup(){const t=ue(),r=j(),o=oe(),e=o.params.symbol,d=o.params.currency,l={proxy:gnl.cors,options:{tradesLimit:10},newUpdates:!0,timeout:2e4};if(r.exchange===null&&(r.exchange=new ccxt.pro[provider](l)),r.futuresExchange===null)if(provider!=="bitget")r.futuresExchange=r.exchange;else{const b=provider!=="kucoin"?provider:"kucoinfutures";r.futuresExchange=new ccxt.pro[b](l)}const i=async()=>{r.futures.length===0&&await r.fetch_futures(),r.future=r.futures[d][e+"/"+d+":"+d],r.markets.length===0&&await r.fetch_markets(),r.market=r.markets[d][e+"/"+d]};r.future||i();const c=we();async function m(){plat.kyc.kyc_status==1&&Number(plat.kyc.futures_restriction)===1&&(t.user||await t.fetch(),t.user.kyc_application||c.push("/identity"),t.user.kyc_application&&t.user.kyc_application.level<2&&t.user.kyc_application.status!=="approved"&&c.push("/identity"))}return se(()=>{m()}),{userStore:t,marketStore:r}},data(){return{symbol:this.$route.params.symbol,currency:this.$route.params.currency,provide:null,provider,fee:null,index:0,ordersRender:0,ext,plat,ordercard:!1,orderbtn:!0,activeItem:plat.mobile.charting==1?"pills-chart":"pills-orderbook"}},watch:{eventLog:function(){const t=this.$refs.eventsDiv;t.scrollTop=t.scrollHeight},async $route(t,r){await this.marketStore.exchange.close(),document.getElementById("favicon").href="/assets/images/logoIcon/favicon.ico";const o=document.getElementById("asks"),e=document.getElementById("bids"),d=document.getElementById("tradeTable");o!==null&&(o.innerHTML=""),e!==null&&(e.innerHTML=""),d!==null&&(d.innerHTML="")}},created(){this.fetchData()},methods:{isActive(t){return this.activeItem===t},setActive(t){this.activeItem=t},getRandomInt(t,r){return t=Math.ceil(t),r=Math.floor(r),Math.floor(Math.random()*(r-t))+t},renderOrders(){this.ordersRender+=1},setBestAsk(t){this.ask=t},setBestBid(t){this.bid=t},fetchData(){axios.post("/user/trade/"+this.$route.params.symbol+"/"+this.$route.params.currency).then(t=>{t.message=="Verify your identify first!"&&(window.location.href="/user/kyc"),this.provide=t.provide,this.fee=t.fee})}}},oo={style:{"font-family":"BinancePlex, Arial, sans-serif !important"}},so={class:"containered",style:{margin:"-18px -20px 3px -20px"}},no={id:"creatable",class:"Chart border border-gray-100 bg-white shadow dark:border-gray-700 dark:bg-gray-900"},io={class:"Order border border-gray-100 bg-white shadow dark:border-gray-700 dark:bg-gray-900"},lo={class:"w-full bg-gray-200 dark:bg-gray-800"},co={id:"myTab",class:"nf flex-cols -mb-px flex overflow-x-hidden text-center",role:"tablist"};function uo(t,r,o,e,d,l){const i=p("Marketinfo"),c=p("Orderbook"),m=p("Markets"),b=p("Trades"),f=p("EcoTradingview"),y=p("Tradingview"),_=p("Order"),x=p("Orders");return n(),u("div",oo,[a("div",so,[(n(),L(i,{key:t.$route.params.symbol+t.$route.params.currency+"marketinfo"})),(n(),L(c,{key:t.$route.params.symbol+t.$route.params.currency+"orderbook",type:t.$route.meta.type},null,8,["type"])),g(m,{style:{"overflow-y":"auto","overflow-x":"hidden"},type:t.$route.meta.type,subtype:"non"},null,8,["type"]),(n(),L(b,{key:t.$route.params.symbol+t.$route.params.currency+"trades",style:{"overflow-y":"auto","overflow-x":"hidden"}})),a("div",no,[d.ext.eco==1&&d.provider!="coinbasepro"?(n(),L(f,{key:t.$route.params.symbol+t.$route.params.currency+"eco"})):(n(),u(z,{key:1},[d.provide!=null?(n(),L(y,{key:t.$route.params.symbol+t.$route.params.currency+"tradingview",provide:d.provide},null,8,["provide"])):O("",!0)],64))]),(n(),L(Se,null,{fallback:h(()=>[a("div",io,[a("div",lo,[a("ul",co,[a("li",null,[a("a",{class:P(["inline-block py-2 pl-3 pr-4 text-xs font-medium",l.isActive("tab-market")?"border-gray-300 bg-white text-gray-600 dark:bg-gray-900 dark:text-gray-300":"cursor-pointer border-transparent bg-gray-200 hover:border-gray-300 hover:bg-gray-300 hover:text-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-gray-300"]),onClick:r[1]||(r[1]=$(C=>l.setActive("tab-market"),["prevent"]))},s(t.$t("Spot")),3)]),a("li",null,[a("a",{class:P(["inline-block py-2 pl-3 pr-4 text-xs font-medium",l.isActive("tab-limit")?"border-gray-300 bg-white text-gray-600 dark:bg-gray-900 dark:text-gray-300":"cursor-pointer border-transparent bg-gray-200 hover:border-gray-300 hover:bg-gray-300 hover:text-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-gray-300"]),onClick:r[2]||(r[2]=$(C=>l.setActive("tab-limit"),["prevent"]))},s(t.$t("Limit")),3)]),a("li",null,[a("a",{class:P(["inline-block py-2 pl-3 pr-4 text-xs font-medium",l.isActive("tab-wallets")?"border-gray-300 bg-white text-gray-600 dark:bg-gray-900 dark:text-gray-300":"cursor-pointer border-transparent bg-gray-200 hover:border-gray-300 hover:bg-gray-300 hover:text-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-gray-300"]),onClick:r[3]||(r[3]=$(C=>l.setActive("tab-wallets"),["prevent"]))},s(t.$t("Wallets")),3)])])])])]),default:h(()=>[(n(),L(_,{key:t.$route.params.symbol+t.$route.params.currency+"order",fee:d.fee,onOrderPlaced:r[0]||(r[0]=C=>l.renderOrders())},null,8,["fee"]))]),_:1}))]),(n(),L(x,{key:t.$route.params.symbol+t.$route.params.currency+d.ordersRender}))])}const Bo=I(ao,[["render",uo]]);export{Bo as default};
