import{_ as b,o as i,c as _,a as t,t as n,f as k,r as f,i as c,p as j,F as P,b as S,e as w,w as m,T as L,n as q,g as $,h as T,U as N,k as y,y as B,x as F}from"./bootstrap-249b0f62.js";import{K as D}from"./flowbite-vue-7e69f603.js";import{F as A}from"./Filter-3bb21f90.js";import{C as O}from"./Col-3a6cbfed.js";import{u as U}from"./wallets-92ad6f06.js";import{B as W}from"./ButtonLoading-6507984c.js";import{u as z}from"./user-5d70a0d6.js";import"./_commonjsHelpers-de833af9.js";import"./dijkstra-f906a09e.js";import"./preload-helper-f61836a9.js";import"./axios-7a713374.js";const E={props:{plan:Object,recommended:Boolean},emits:["show-investment-modal"],methods:{showInvestmentModal(e){this.$emit("show-investment-modal",e)}}},R={class:"card"},K={class:"card-header flex justify-between"},G={class:"text-lg font-semibold md:text-base"},H={key:0,class:"badge bg-success"},J={class:"card-body"},Q={class:""},X={class:"mt-4 flex flex-wrap justify-between"},Y={class:"mb-2 flex items-center md:mb-0"},Z={class:"text-dark text-lg font-bold md:text-base"},tt={class:"text-lg font-bold md:text-base"},et={class:"flex items-center"},st={class:"mr-2"},nt={class:"text-dark font-bold md:text-base"},ot={class:"mt-4 flex flex-wrap justify-between"},at={class:"mb-2 flex items-center md:mb-0"},lt={class:"mr-2"},it={class:"text-dark font-bold md:text-base"},dt={class:"flex items-center"},rt={class:"mr-2"},ct={class:"text-dark font-bold md:text-base"},mt={class:"card-footer"};function ut(e,s,o,d,a,r){return i(),_("div",R,[t("div",K,[t("h3",G,n(o.plan.name),1),o.plan.recommanded==1?(i(),_("div",H,n(e.$t("Recommended")),1)):k("",!0)]),t("div",J,[t("p",Q,n(o.plan.description),1),t("div",X,[t("div",Y,[s[1]||(s[1]=t("span",{class:"text-dark text-lg font-semibold md:text-base"},"$",-1)),t("span",Z,n(o.plan.min_amount),1),s[2]||(s[2]=t("span",{class:"text-lg font-semibold md:text-base"}," - $",-1)),t("span",tt,n(o.plan.max_amount),1)]),t("div",et,[t("span",st,n(e.$t("Duration"))+":",1),t("span",nt,n(o.plan.duration_in_days)+n(e.$t("days")),1)])]),t("div",ot,[t("div",at,[t("span",lt,n(e.$t("Interest Rate"))+":",1),t("span",it,n(o.plan.interest_rate)+"%",1)]),t("div",dt,[t("span",rt,n(e.$t("Total Investors"))+":",1),t("span",ct,n(o.plan.total_custom_investors),1)])])]),t("div",mt,[t("button",{type:"button",class:"w-full rounded bg-blue-500 py-2 px-4 font-semibold text-white shadow-lg transition-all duration-300 hover:bg-blue-600 hover:shadow-none focus:outline-none focus:ring",onClick:s[0]||(s[0]=v=>r.showInvestmentModal(o.plan))},n(e.$t("Invest Now")),1)])])}const _t=b(E,[["render",ut]]),vt={props:{totalInvested:{type:[Number,String],required:!0},totalProfit:{type:[Number,String],required:!0},todayProfit:{type:[Number,String],required:!0}}},ft={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},gt={class:"card"},ht={class:"card-header"},pt={class:"card-title"},yt={class:"title-gradient"},bt={class:"card-body"},$t={class:"text-3xl font-bold"},xt={class:"card"},wt={class:"card-header"},kt={class:"card-title"},It={class:"title-gradient"},Ct={class:"card-body"},Pt={class:"text-3xl font-bold"},Mt={class:"card"},St={class:"card-header"},Lt={class:"card-title"},Tt={class:"title-gradient"},Nt={class:"card-body"},Dt={class:"text-3xl font-bold"};function Vt(e,s,o,d,a,r){return i(),_("div",ft,[t("div",gt,[t("div",ht,[t("div",pt,[t("div",yt,n(e.$t("Total Invested")),1)])]),t("div",bt,[t("div",$t,"$"+n(o.totalInvested),1)])]),t("div",xt,[t("div",wt,[t("div",kt,[t("div",It,n(e.$t("Total Profit")),1)])]),t("div",Ct,[t("div",Pt,"$"+n(o.totalProfit),1)])]),t("div",Mt,[t("div",St,[t("div",Lt,[t("div",Tt,n(e.$t("Today's Profit")),1)])]),t("div",Nt,[t("div",Dt,"$"+n(o.todayProfit),1)])])])}const jt=b(vt,[["render",Vt]]),qt={components:{InvestmentPlan:_t,InvestmentOverview:jt},props:{plans:{type:Array,required:!0},totalInvested:{type:[Number,String],required:!0},totalProfit:{type:[Number,String],required:!0},todayProfit:{type:[Number,String],required:!0}},emits:["start-investment"],data(){return{isLoading:!0}},watch:{plans(e){e&&e.length>0?this.isLoading=!1:this.isLoading=!0}},methods:{startInvestment(e){this.$emit("start-investment",e)}}},Bt={class:"flex flex-col lg:flex-row lg:space-x-8"},Ft={class:"mt-5 w-full lg:w-3/4"},At={class:"text-xl font-semibold"},Ot={class:"mt-4"},Ut={class:"grid gap-4 xs:grid-cols-1 md:grid-cols-2 lg:grid-cols-3"},Wt={key:0},zt={key:1},Et={class:"rounded-md border border-gray-300 p-4 text-gray-500"},Rt={class:"text-center"};function Kt(e,s,o,d,a,r){const v=f("InvestmentOverview"),l=f("InvestmentPlan");return i(),_(P,null,[c(v,{"total-invested":o.totalInvested,"total-profit":o.totalProfit,"today-profit":o.todayProfit},null,8,["total-invested","total-profit","today-profit"]),t("div",Bt,[t("div",Ft,[t("h2",At,n(e.$t("Investment Plans")),1),t("div",Ot,[t("div",Ut,[a.isLoading?(i(),_("div",Wt,s[0]||(s[0]=[j('<div class="card animate-pulse"><div class="card-body"><div class="skeleton mb-2 h-4 w-3/4 rounded bg-gray-400"></div><div class="skeleton mb-2 h-4 w-1/2 rounded bg-gray-400"></div><div class="skeleton mb-2 h-4 w-3/4 rounded bg-gray-400"></div><div class="skeleton h-4 w-1/3 rounded bg-gray-400"></div></div><div class="card-footer"><div class="skeleton h-4 w-1/3 rounded bg-gray-400"></div></div></div>',1)]))):o.plans.length===0?(i(),_("div",zt,[t("div",Et,[t("p",Rt,n(e.$t("No plans available at this time. Please check back later"))+". ",1)])])):(i(!0),_(P,{key:2},S(o.plans,(u,x)=>(i(),w(l,{key:x,plan:u,onShowInvestmentModal:I=>r.startInvestment(u)},null,8,["plan","onShowInvestmentModal"]))),128))])])])])],64)}const Gt=b(qt,[["render",Kt]]),Ht={name:"ConfirmationModal",components:{Modal:D},emits:["cancel","confirm"]},Jt={class:"flex items-center text-lg"},Qt={id:"modal-headline",class:"text-lg"},Xt={class:"font-medium"},Yt={class:"flex justify-end"};function Zt(e,s,o,d,a,r){const v=f("Modal");return i(),w(L,{name:"modal",mode:"out-in","enter-active-class":"modal-enter-active","leave-active-class":"modal-leave-active"},{default:m(()=>[c(v,{size:"2xl",onClose:s[2]||(s[2]=l=>e.$emit("cancel"))},{header:m(()=>[t("div",Jt,[t("h3",Qt,n(e.$t("Cancel Investment Confirmation")),1)])]),body:m(()=>[t("span",Xt,n(e.$t("Are you sure you want to perform this action"))+"?",1)]),footer:m(()=>[t("div",Yt,[t("button",{type:"button",class:"btn btn-outline-danger mr-3",onClick:s[0]||(s[0]=l=>e.$emit("confirm"))},n(e.$t("Confirm")),1),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:s[1]||(s[1]=l=>e.$emit("cancel"))},n(e.$t("Cancel")),1)])]),_:1})]),_:1})}const te=b(Ht,[["render",Zt]]),ee={components:{ConfirmationModal:te},props:{log:{type:Object,required:!0}},emits:["cancel-log"],data(){return{showConfirmationModal:!1}},methods:{formatDate(e){return new Date(e).toLocaleDateString()},getStatusText(e){switch(e){case 1:return"Active";case 2:return"Completed";case 3:return"Cancelled";default:return""}},getStatusStyle(e){switch(e){case 1:return"bg-primary";case 2:return"bg-success";case 3:return"bg-danger";default:return""}},isCancelable(e){return e===1},cancelLog(){this.$emit("cancel-log",this.log.id),this.showConfirmationModal=!1}}},se={class:"border-b bg-white dark:border-gray-700 dark:bg-gray-800"},ne={class:"py-3 px-6"},oe={class:"py-3 px-6"},ae={class:"py-3 px-6"},le={class:"py-3 px-6"},ie={class:"py-3 px-6"},de={class:"py-3 px-6"},re={class:"py-3 px-6"},ce={class:"py-3 px-6"};function me(e,s,o,d,a,r){const v=f("confirmation-modal");return i(),_("tr",se,[t("td",ne,n(o.log.trx),1),t("td",oe,n(o.log.plan.name),1),t("td",ae,n(o.log.amount),1),t("td",le,n(o.log.profit),1),t("td",ie,n(r.formatDate(o.log.created_at)),1),t("td",de,n(r.formatDate(o.log.end_date)),1),t("td",re,[t("span",{class:q(["badge",r.getStatusStyle(o.log.status)])},n(r.getStatusText(o.log.status)),3)]),t("td",ce,[r.isCancelable(o.log.status)?(i(),_("button",{key:0,class:"btn btn-sm btn-danger",onClick:s[0]||(s[0]=l=>a.showConfirmationModal=!0)},n(e.$t("Cancel")),1)):k("",!0),a.showConfirmationModal?(i(),w(v,{key:1,onConfirm:r.cancelLog,onCancel:s[1]||(s[1]=l=>a.showConfirmationModal=!1)},{default:m(()=>[$(n(e.$t("Are you sure you want to cancel this investment"))+"? ",1)]),_:1},8,["onConfirm"])):k("",!0)])])}const ue=b(ee,[["render",me]]),_e={components:{InvestmentLog:ue,Filter:A,Col:O},props:{logs:{type:Object,required:!0}},emits:["investment-cancel"],data(){return{filters:{trx:{value:"",keys:["trx"]}},currentPage:1,totalPages:0}},mounted(){console.log("Received logs from parent:",this.logs)},methods:{cancelLog(e){axios.post("/user/investment/log/cancel",{id:e}).then(s=>{this.$emit("investment-cancel"),this.$toast[s.type||"success"](s.message||"Investment cancelled successfully")}).catch(s=>{console.log(s),this.$toast[s.response.data.type||"error"](s.response.data.message||"Error cancelling investment")})}}},ve={class:"mb-4 items-center justify-between xs:block xs:space-y-5 sm:flex sm:space-y-0"},fe={class:"font-medium"},ge={key:0,class:"card relative overflow-x-auto"},he={class:"bg-gray-100 text-xs uppercase text-gray-700 dark:bg-gray-700 dark:text-gray-400"},pe={scope:"col",class:"py-3 px-6"},ye={scope:"col",class:"py-3 px-6"},be={scope:"col",class:"py-3 px-6"},$e={class:"py-3 px-6"},xe={key:1,class:"border-b bg-white dark:border-gray-700 dark:bg-gray-800"},we={colspan:"100%",class:"py-4 px-6"},ke={class:"sr-only"},Ie={class:"sr-only"};function Ce(e,s,o,d,a,r){const v=f("Filter"),l=f("Col"),u=f("VTh"),x=f("InvestmentLog"),I=f("VTable"),C=f("VTPagination");return i(),_("div",null,[t("div",ve,[t("div",fe,n(e.$t("Investments Log")),1),c(v,null,{default:m(()=>[T(t("input",{"onUpdate:modelValue":s[0]||(s[0]=g=>a.filters.trx.value=g),type:"text",class:"filter-input",placeholder:"Transaction ID"},null,512),[[N,a.filters.trx.value]])]),_:1})]),o.logs!=null?(i(),_("div",ge,[c(I,{"current-page":a.currentPage,"onUpdate:currentPage":s[1]||(s[1]=g=>a.currentPage=g),class:"w-full text-left text-sm text-gray-500 dark:text-gray-400",data:o.logs,filters:a.filters,"page-size":20,"hide-sort-icons":!0,onTotalPagesChanged:s[2]||(s[2]=g=>a.totalPages=g)},{head:m(()=>[t("tr",he,[c(u,{"sort-key":"id",scope:"col",class:"py-3 px-6"},{default:m(()=>[c(l,{text:"Transaction ID"})]),_:1}),t("th",pe,[c(l,{text:"Plan"})]),t("th",ye,[c(l,{text:"Amount"})]),t("th",be,[c(l,{text:"Profit"})]),c(u,{"sort-key":"created_at",scope:"col",class:"py-3 px-6"},{default:m(()=>[c(l,{text:"Start Date"})]),_:1}),c(u,{"sort-key":"end_date",scope:"col",class:"py-3 px-6"},{default:m(()=>[c(l,{text:"End Date"})]),_:1}),c(u,{"sort-key":"status",scope:"col",class:"py-3 px-6"},{default:m(()=>[c(l,{text:"Status"})]),_:1}),t("th",$e,n(e.$t("Actions")),1)])]),body:m(({rows:g})=>[o.logs.length>0?(i(!0),_(P,{key:0},S(g,p=>(i(),w(x,{key:p.id,log:p,onCancelLog:r.cancelLog},null,8,["log","onCancelLog"]))),128)):(i(),_("tr",xe,[t("td",we,n(e.$t("No results found!")),1)]))]),_:1},8,["current-page","data","filters"])])):k("",!0),c(C,{currentPage:a.currentPage,"onUpdate:currentPage":s[3]||(s[3]=g=>a.currentPage=g),class:"float-right flex items-center justify-between pt-4","aria-label":"Table navigation","total-pages":a.totalPages,"max-page-links":3,"boundary-links":!0},{firstPage:m(()=>[$(n(e.$t("First")),1)]),lastPage:m(()=>[$(n(e.$t("Last")),1)]),next:m(()=>[t("span",ke,n(e.$t("Next")),1),s[4]||(s[4]=t("svg",{class:"h-5 w-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1))]),previous:m(()=>[t("span",Ie,n(e.$t("Previous")),1),s[5]||(s[5]=t("svg",{class:"h-5 w-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1))]),_:1},8,["currentPage","total-pages"])])}const Pe=b(_e,[["render",Ce]]),Me={name:"InvestmentModal",components:{Modal:D,ButtonLoading:W},props:{plan:{type:Object,required:!0},wallet:{type:Object,required:!0}},emits:["investment-made","close-modal","wallet-created"],setup(){return{walletsStore:U()}},data(){return{amount:0,loading:!1,wallet_id:null}},methods:{CreateWallet(){this.walletsStore.create("USDT","funding"),this.$emit("wallet-created")},invest(){if(this.amount>this.plan.max_amount)return this.$toast.error(`Amount cannot be greater than ${this.plan.max_amount}`);if(this.amount<this.plan.min_amount)return this.$toast.error(`Amount cannot be less than ${this.plan.min_amount}`);this.loading=!0,axios.post("/user/investment/store",{investment_plan_id:this.plan.id,amount:this.amount}).then(e=>{this.$emit("investment-made"),this.$toast[e.type](e.message)}).catch(e=>{this.$emit("close-modal"),this.$toast[e.response.data.type](e.response.data.message)}).finally(()=>{this.loading=!1})}}},Se={class:"flex items-center text-lg"},Le={id:"modal-headline",class:"text-lg"},Te={class:"mb-5"},Ne={key:0},De={for:"wallet_id"},Ve={class:"flex items-center"},je={class:"text-warning font-medium"},qe={key:1},Be={class:"text-success font-medium"},Fe=["min","max"],Ae={class:"text-warning font-medium"},Oe={class:"text-warning font-medium"},Ue={class:"flex justify-end"},We=["disabled"];function ze(e,s,o,d,a,r){const v=f("ButtonLoading"),l=f("Modal");return i(),w(L,{name:"modal",mode:"out-in","enter-active-class":"modal-enter-active","leave-active-class":"modal-leave-active"},{default:m(()=>[c(l,{size:"2xl",onClose:s[4]||(s[4]=u=>e.$emit("close-modal"))},{header:m(()=>[t("div",Se,[t("h3",Le,n(e.$t("Invest in"))+" "+n(o.plan.name),1)])]),body:m(()=>[t("div",Te,[o.wallet?(i(),_("div",Ne,[t("label",De,"USDT "+n(e.$t("Funding Wallet"))+":",1),t("div",Ve,[t("span",je,n(Number(o.wallet.balance).toFixed(2))+" "+n(o.wallet.symbol),1)])])):(i(),_("div",qe,[t("button",{class:"btn btn-primary",onClick:s[0]||(s[0]=u=>r.CreateWallet())},n(e.$t("Create Wallet")),1)]))]),t("div",null,[t("label",null,[$(n(e.$t("Please enter the amount you wish to invest and click"))+' "',1),t("span",Be,n(e.$t("Invest Now")),1),s[5]||(s[5]=$('" '))]),T(t("input",{"onUpdate:modelValue":s[1]||(s[1]=u=>a.amount=u),type:"number",min:o.plan.min_amount,max:o.plan.max_amount,step:"1",class:"form-control",placeholder:"Enter investment amount"},null,8,Fe),[[N,a.amount,void 0,{number:!0}]]),t("small",null,[t("span",Ae,n(e.$t("Min")),1),$(": "+n(o.plan.min_amount)+" / ",1),t("span",Oe,n(e.$t("Max")),1),$(": "+n(o.plan.max_amount),1)])])]),footer:m(()=>[t("div",Ue,[t("button",{type:"button",class:"btn btn-outline-success mr-3",disabled:a.loading||!o.wallet,onClick:s[2]||(s[2]=u=>r.invest())},[c(v,{loading:a.loading,text:"Invest Now"},null,8,["loading"])],8,We),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:s[3]||(s[3]=u=>e.$emit("close-modal"))}," Close ")])]),_:1})]),_:1})}const Ee=b(Me,[["render",ze]]),Re={name:"Investment",components:{InvestmentPlans:Gt,InvestmentLogs:Pe,InvestmentModal:Ee},setup(){const e="Investment Plans and Logs",s=y([]),o=y([]),d=y([]),a=y(!1),r=y(null),v=y(0),l=y(0),u=y(0),x=()=>{axios.get("/user/investment").then(h=>{s.value=h.plans,o.value=h.logs,v.value=h.totalInvested,l.value=h.totalProfit,u.value=h.todayProfit,d.value=h.wallet,console.log("Total Profit:",l.value)}).catch(h=>{console.log(h)})},I=h=>{r.value=h,a.value=!0},C=()=>{a.value=!1},g=()=>{x(),a.value=!1},p=z(),M=B();async function V(){plat.kyc.kyc_status==1&&Number(plat.kyc.investments_restriction)===1&&(p.user||await p.fetch(),p.user.kyc_application||M.push("/identity"),p.user.kyc_application&&p.user.kyc_application.level<2&&p.user.kyc_application.status!=="approved"&&M.push("/identity"))}return F(()=>{V(),x()}),{pageTitle:e,plans:s,logs:o,wallet:d,showModal:a,selectedPlan:r,totalInvested:v,totalProfit:l,todayProfit:u,showInvestmentModal:I,closeInvestmentModal:C,completeInvestment:g}}},Ke={class:"space-y-5"};function Ge(e,s,o,d,a,r){const v=f("investment-plans"),l=f("investment-logs"),u=f("investment-modal");return i(),_("div",Ke,[c(v,{plans:d.plans,"total-invested":d.totalInvested,"total-profit":d.totalProfit,"today-profit":d.todayProfit,onStartInvestment:d.showInvestmentModal},null,8,["plans","total-invested","total-profit","today-profit","onStartInvestment"]),c(l,{logs:d.logs,onInvestmentCancel:e.fetchData},null,8,["logs","onInvestmentCancel"]),d.showModal==!0?(i(),w(u,{key:0,plan:d.selectedPlan,wallet:d.wallet,onCloseModal:d.closeInvestmentModal,onInvestmentMade:d.completeInvestment,onWalletCreated:e.fetchData},null,8,["plan","wallet","onCloseModal","onInvestmentMade","onWalletCreated"])):k("",!0)])}const as=b(Re,[["render",Ge]]);export{as as default};
