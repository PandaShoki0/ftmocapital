import{_ as D,V as I,G as T,l as b,u as V,x as H,r as S,o as c,c as m,a as e,n as u,q as M,t as h,e as N,f as _,i as R}from"./bootstrap-249b0f62.js";import{L as q}from"./ListItem-a6b6e883.js";import{u as G}from"./market-8356724b.js";import{L as W}from"./LoadingCircles-d67a70a4.js";import"./_commonjsHelpers-de833af9.js";import"./dijkstra-f906a09e.js";import"./preload-helper-f61836a9.js";import"./axios-7a713374.js";/* empty css                                                                       */const j={components:{ListItem:q,LoadingCircles:W},setup(){const n=G(),l=I(),o=T({limit:{asks:12,bids:12},showMoreAsks:!1,showMoreBids:!1,sideLength:20,refreshRate:500,best_ask:"",best_ask_icon:"",lastUpdated:"",activeItem:"pills-graph",data:{},asks:Array.from({length:20},()=>[0,0,0,0]),bids:Array.from({length:20},()=>[0,0,0,0]),isLoading:!0,bestAsker:0}),t=l.params.symbol,x=l.params.currency,B=window.provider,k=l.meta.type==="futures"?"future":"market",v=b(()=>n[k]?A(n[k].precision.amount||1e-6):6),w=b(()=>n[k]?A(n[k].precision.price||1e-6):6);function A(s){if(Math.floor(s)===s)return 0;const i=s.toString(),a=/^(\d+\.?\d*|\.\d+)e([\+\-]\d+)$/.exec(i);if(a){const d=(a[1].split(".")[1]||"").length+parseInt(a[2]);return Math.min(d,8)}else{const r=i.split(".")[1]||"";return Math.min(r.length,8)}}function f(s,i=8,a=","){if(s==null||isNaN(s))return 0;(i<0||i>100)&&(i=8),s=parseFloat(s).toFixed(i);let[r,d]=s.toString().split(".");return r=r.replace(/\B(?=(\d{3})+(?!\d))/g,a),s=d?`${r}.${d}`:r,s}const p={sort(s){return s.sort((i,a)=>i[1]-a[1])},median(s){const i=Math.floor(s.length/3*2);return s[i][1]<1?1:s[i][1]},medianUnit(s,i,a){const r=[...s,...i];return this.median(this.sort(r))/a},width(s,i){if(i===0)return 1;const a=Math.round(Number(s)/i);return a<=0?1:Math.min(160,a)}};function O(s,i){const a=p.medianUnit(s,i,48);s.forEach(r=>{r.push({width:p.width(r[1],a)*2.5})}),i.forEach(r=>{r.push({width:p.width(r[1],a)*2.5})})}function z(){const s=[...o.asks,...o.bids],i=p.medianUnit(o.asks,o.bids,48);s.forEach(a=>{typeof a[2]!="number"&&(a[2].width=p.width(a[1],i)*2.5)})}const E={width:250,sortwidth:p,init:O};V(()=>o.asks,()=>{z()},{deep:!0}),V(()=>o.bids,()=>{z()},{deep:!0});const F=b(()=>(o.showMoreAsks?o.asks:o.asks.slice(0,o.limit.asks)).slice().reverse().map(([a,r,{width:d}])=>[f(a,w.value),f(r,v.value),f(a*r,w.value),d])),U=b(()=>o.bids.map(([s,i,{width:a}])=>[f(s,w.value),f(i,v.value),f(s*i,w.value),a]));async function L(s){const i=Date.now(),a=B==="bitget",r=a?s.asks.slice(0,o.sideLength):s.asks,d=a?s.bids.slice(0,o.sideLength):s.bids;E.init(d,r),r.sort((g,y)=>g[0]-y[0]),d.sort((g,y)=>g[0]-y[0]);const P=r[0][0]>o.bestAsker;o.best_ask=P?"text-success":"text-danger",o.best_ask_icon=P?"bi-arrow-up text-success":"bi-arrow-down text-danger",o.bestAsker=r[0][0],o.lastUpdated=i,o.asks.splice(0,o.sideLength,...r),o.bids.splice(0,o.sideLength,...d),n.bestAsk=r[0][0],n.bestBid=d[d.length-1][0],i-o.lastUpdated<=o.refreshRate&&(await new Promise(g=>requestAnimationFrame(g)),await new Promise(g=>setTimeout(g,o.refreshRate/2)))}async function C(){for(n.exchange||await new Promise(s=>setTimeout(s,1e3));window.location.href.indexOf(`${t}/${x}`)>-1;)try{const s=await n.exchange.watchOrderBook(`${t}/${x}`,o.sideLength);o.isLoading=!1,await L(s)}catch{break}}return H(()=>{C()}),{marketStore:n,state:o,formattedAsks:F,formattedBids:U,priceFormatter:f,updateOrderbook:L,loopOrderbook:C}}},J={class:"Orderbook border border-gray-100 bg-white shadow dark:border-gray-700 dark:bg-gray-900 relative"},K={class:"flex p-1 xs:hidden md:flex",role:"tablist"},Q={class:"p-1"},X={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"css-3kwgah",style:{margin:"0px","min-width":"0px","font-size":"24px",width:"1em",height:"1em"}},Y={class:"p-1"},Z={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"css-3kwgah",style:{margin:"0px","min-width":"0px","font-size":"24px",width:"1em",height:"1em"}},$={class:"p-1"},tt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"css-3kwgah",style:{margin:"0px","min-width":"0px","font-size":"24px",width:"1em",height:"1em"}},st={key:0,class:"Asks"},et={style:{"overflow-x":"hidden"}},ot={class:""},it={class:"text-start",style:{"padding-left":"5px"},scope:"col"},at={class:"text-center if-sm",scope:"col"},rt={class:"text-end",style:{"padding-right":"5px"},scope:"col"},nt={class:"LastPrice xs:hidden md:block"},lt={class:"p-3"},dt={class:""},ct={key:1,class:"Bids"},ht={style:{"overflow-x":"hidden"}},mt={key:0,class:""},kt={class:"pl-2 text-start",scope:"col"},wt={class:"text-center if-sm",scope:"col"},ft={class:"text-end",scope:"col"},gt={key:1,class:"xs:flex md:hidden"},pt={class:"pl-2 text-start",scope:"col"},ut={class:"text-center if-sm",scope:"col"},vt={class:"text-end",scope:"col"};function bt(n,l,o,t,x,B){const k=S("ListItem"),v=S("loading-circles");return c(),m("div",J,[e("ul",K,[e("li",Q,[e("button",{class:u({"text-gray-200 dark:text-gray-600":t.state.showMoreAsks||t.state.showMoreBids||t.state.showMoreAsks&&t.state.showMoreBids}),onClick:l[0]||(l[0]=M(w=>(t.state.showMoreAsks=!1,t.state.showMoreBids=!1,t.state.limit.asks=12,t.state.limit.bids=12),["prevent"]))},[(c(),m("svg",X,l[3]||(l[3]=[e("path",{d:"M4 4h7v7H4V4z",fill:"#F6465D"},null,-1),e("path",{d:"M4 13h7v7H4v-7z",fill:"#0ECB81"},null,-1),e("path",{d:"M13 4h7v4h-7V4zm0 6h7v4h-7v-4zm7 6h-7v4h7v-4z",fill:"currentColor"},null,-1)])))],2)]),e("li",Y,[e("button",{class:u({"text-gray-200 dark:text-gray-600":!t.state.showMoreBids||t.state.showMoreAsks}),onClick:l[1]||(l[1]=M(w=>(t.state.showMoreAsks=!1,t.state.showMoreBids=!0,t.state.limit.asks=0,t.state.limit.bids=20),["prevent"]))},[(c(),m("svg",Z,l[4]||(l[4]=[e("path",{d:"M4 4h7v16H4V4z",fill:"#0ECB81"},null,-1),e("path",{d:"M13 4h7v4h-7V4zm0 6h7v4h-7v-4zm7 6h-7v4h7v-4z",fill:"currentColor"},null,-1)])))],2)]),e("li",$,[e("button",{class:u({"text-gray-200 dark:text-gray-600":t.state.showMoreBids||!t.state.showMoreAsks}),onClick:l[2]||(l[2]=M(w=>(t.state.showMoreAsks=!0,t.state.showMoreBids=!1,t.state.limit.asks=20,t.state.limit.bids=0),["prevent"]))},[(c(),m("svg",tt,l[5]||(l[5]=[e("path",{d:"M4 4h7v16H4V4z",fill:"#F6465D"},null,-1),e("path",{d:"M13 4h7v4h-7V4zm0 6h7v4h-7v-4zm7 6h-7v4h7v-4z",fill:"currentColor"},null,-1)])))],2)])]),(c(),m("div",{key:t.state.limit.asks,class:"OrderbookGrid"},[t.state.limit.asks!=0?(c(),m("div",st,[e("table",et,[e("thead",ot,[e("th",it,h(n.$t("Price")),1),e("th",at,h(n.$t("Amount")),1),e("th",rt,h(n.$t("Total")),1)]),e("tbody",null,[(c(),N(k,{key:t.state.showMoreBids,data:t.formattedAsks,type:"ask","show-less":t.state.showMoreBids,limit:t.state.limit.asks},null,8,["data","show-less","limit"]))])])])):_("",!0),e("div",nt,[e("div",lt,[e("span",dt,h(n.$t("Last Price"))+": ",1),e("span",{class:u(t.state.best_ask)},h(t.marketStore.bestAsk??""),3),e("i",{class:u(["bi",t.state.best_ask_icon])},null,2)])]),t.state.limit.bids!=0?(c(),m("div",ct,[e("table",ht,[t.state.limit.asks==0?(c(),m("thead",mt,[e("th",kt,h(n.$t("Price")),1),e("th",wt,h(n.$t("Amount")),1),e("th",ft,h(n.$t("Total")),1)])):_("",!0),t.state.limit.asks!=0?(c(),m("thead",gt,[e("th",pt,h(n.$t("Price")),1),e("th",ut,h(n.$t("Amount")),1),e("th",vt,h(n.$t("Total")),1)])):_("",!0),e("tbody",null,[(c(),N(k,{key:t.state.showMoreAsks,data:t.formattedBids,type:"bid","show-less":t.state.showMoreAsks,limit:t.state.limit.bids},null,8,["data","show-less","limit"]))])])])):_("",!0)])),R(v,{loading:t.state.isLoading},null,8,["loading"])])}const Pt=D(j,[["render",bt]]);export{Pt as default};
