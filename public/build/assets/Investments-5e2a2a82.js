import{u as A}from"./user-2eca6249.js";import{_ as b,o as d,c as _,a as t,t as s,f as k,r as h,i as c,F as P,d as S,e as w,p as V,w as m,T as L,n as j,g as $,h as T,X as N,k as y,u as B,z as F}from"./bootstrap-9979bcf7.js";import{K as D}from"./flowbite-vue-3e651750.js";import{F as O}from"./Filter-f10b47ed.js";import{C as z}from"./Col-4463c6d7.js";import{u as U}from"./wallets-5d4d7fa5.js";import{B as W}from"./ButtonLoading-97716eba.js";import{u as E}from"./user-4c9e2e6d.js";import"./preload-helper-f61836a9.js";import"./_commonjsHelpers-de833af9.js";import"./axios-4a70c6fc.js";import"./browser-77dd377d.js";const R={props:{plan:Object,recommended:Boolean},setup(){const{showAllAlertsSequentially:e,hasLicensePrompt:n,hasLimitExceeded:o,hasPend:l}=A();return{showAllAlertsSequentially:e,hasLicensePrompt:n,hasLimitExceeded:o,hasPend:l}},emits:["show-investment-modal"],methods:{showInvestmentModal(e){if(this.hasPend()||this.hasLicensePrompt()||this.hasLimitExceeded()){this.showAllAlertsSequentially();return}this.$emit("show-investment-modal",e)}}},K={class:"card"},X={class:"card-header flex justify-between"},G={class:"text-lg font-semibold md:text-base"},H={key:0,class:"badge bg-success"},J={class:"card-body"},Q={class:""},Y={class:"mt-4 flex flex-wrap justify-between"},Z={class:"mb-2 flex items-center md:mb-0"},tt=t("span",{class:"text-dark text-lg font-semibold md:text-base"},"$",-1),et={class:"text-dark text-lg font-bold md:text-base"},st=t("span",{class:"text-lg font-semibold md:text-base"}," - $",-1),nt={class:"text-lg font-bold md:text-base"},ot={class:"flex items-center"},at={class:"mr-2"},lt={class:"text-dark font-bold md:text-base"},it={class:"mt-4 flex flex-wrap justify-between"},dt={class:"mb-2 flex items-center md:mb-0"},rt={class:"mr-2"},ct={class:"text-dark font-bold md:text-base"},mt={class:"flex items-center"},ut={class:"mr-2"},_t={class:"text-dark font-bold md:text-base"},vt={class:"card-footer"};function ht(e,n,o,l,a,r){return d(),_("div",K,[t("div",X,[t("h3",G,s(o.plan.name),1),o.plan.recommanded==1?(d(),_("div",H,s(e.$t("Recommended")),1)):k("",!0)]),t("div",J,[t("p",Q,s(o.plan.description),1),t("div",Y,[t("div",Z,[tt,t("span",et,s(o.plan.min_amount),1),st,t("span",nt,s(o.plan.max_amount),1)]),t("div",ot,[t("span",at,s(e.$t("Duration"))+":",1),t("span",lt,s(o.plan.duration_in_days)+s(e.$t("days")),1)])]),t("div",it,[t("div",dt,[t("span",rt,s(e.$t("Interest Rate"))+":",1),t("span",ct,s(o.plan.interest_rate)+"%",1)]),t("div",mt,[t("span",ut,s(e.$t("Total Investors"))+":",1),t("span",_t,s(o.plan.total_custom_investors),1)])])]),t("div",vt,[t("button",{type:"button",class:"w-full rounded bg-blue-500 py-2 px-4 font-semibold text-white shadow-lg transition-all duration-300 hover:bg-blue-600 hover:shadow-none focus:outline-none focus:ring",onClick:n[0]||(n[0]=v=>r.showInvestmentModal(o.plan))},s(e.$t("Invest Now")),1)])])}const ft=b(R,[["render",ht]]),gt={props:{totalInvested:{type:[Number,String],required:!0},totalProfit:{type:[Number,String],required:!0},todayProfit:{type:[Number,String],required:!0}}},pt={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},yt={class:"card"},bt={class:"card-header"},$t={class:"card-title"},xt={class:"title-gradient"},wt={class:"card-body"},kt={class:"text-3xl font-bold"},It={class:"card"},Ct={class:"card-header"},Pt={class:"card-title"},Mt={class:"title-gradient"},St={class:"card-body"},Lt={class:"text-3xl font-bold"},Tt={class:"card"},Nt={class:"card-header"},Dt={class:"card-title"},qt={class:"title-gradient"},At={class:"card-body"},Vt={class:"text-3xl font-bold"};function jt(e,n,o,l,a,r){return d(),_("div",pt,[t("div",yt,[t("div",bt,[t("div",$t,[t("div",xt,s(e.$t("Total Invested")),1)])]),t("div",wt,[t("div",kt,"$"+s(o.totalInvested),1)])]),t("div",It,[t("div",Ct,[t("div",Pt,[t("div",Mt,s(e.$t("Total Profit")),1)])]),t("div",St,[t("div",Lt,"$"+s(o.totalProfit),1)])]),t("div",Tt,[t("div",Nt,[t("div",Dt,[t("div",qt,s(e.$t("Today's Profit")),1)])]),t("div",At,[t("div",Vt,"$"+s(o.todayProfit),1)])])])}const Bt=b(gt,[["render",jt]]),Ft={components:{InvestmentPlan:ft,InvestmentOverview:Bt},props:{plans:{type:Array,required:!0},totalInvested:{type:[Number,String],required:!0},totalProfit:{type:[Number,String],required:!0},todayProfit:{type:[Number,String],required:!0}},emits:["start-investment"],data(){return{isLoading:!0}},watch:{plans(e){e&&e.length>0?this.isLoading=!1:this.isLoading=!0}},methods:{startInvestment(e){this.$emit("start-investment",e)}}},Ot={class:"flex flex-col lg:flex-row lg:space-x-8"},zt={class:"mt-5 w-full lg:w-3/4"},Ut={class:"text-xl font-semibold"},Wt={class:"mt-4"},Et={class:"grid gap-4 xs:grid-cols-1 md:grid-cols-2 lg:grid-cols-3"},Rt={key:0},Kt=V('<div class="card animate-pulse"><div class="card-body"><div class="skeleton mb-2 h-4 w-3/4 rounded bg-gray-400"></div><div class="skeleton mb-2 h-4 w-1/2 rounded bg-gray-400"></div><div class="skeleton mb-2 h-4 w-3/4 rounded bg-gray-400"></div><div class="skeleton h-4 w-1/3 rounded bg-gray-400"></div></div><div class="card-footer"><div class="skeleton h-4 w-1/3 rounded bg-gray-400"></div></div></div>',1),Xt=[Kt],Gt={key:1},Ht={class:"rounded-md border border-gray-300 p-4 text-gray-500"},Jt={class:"text-center"};function Qt(e,n,o,l,a,r){const v=h("InvestmentOverview"),i=h("InvestmentPlan");return d(),_(P,null,[c(v,{"total-invested":o.totalInvested,"total-profit":o.totalProfit,"today-profit":o.todayProfit},null,8,["total-invested","total-profit","today-profit"]),t("div",Ot,[t("div",zt,[t("h2",Ut,s(e.$t("Investment Plans")),1),t("div",Wt,[t("div",Et,[a.isLoading?(d(),_("div",Rt,Xt)):o.plans.length===0?(d(),_("div",Gt,[t("div",Ht,[t("p",Jt,s(e.$t("No plans available at this time. Please check back later"))+". ",1)])])):(d(!0),_(P,{key:2},S(o.plans,(u,x)=>(d(),w(i,{key:x,plan:u,onShowInvestmentModal:I=>r.startInvestment(u)},null,8,["plan","onShowInvestmentModal"]))),128))])])])])],64)}const Yt=b(Ft,[["render",Qt]]),Zt={name:"ConfirmationModal",components:{Modal:D},emits:["cancel","confirm"]},te={class:"flex items-center text-lg"},ee={id:"modal-headline",class:"text-lg"},se={class:"font-medium"},ne={class:"flex justify-end"};function oe(e,n,o,l,a,r){const v=h("Modal");return d(),w(L,{name:"modal",mode:"out-in","enter-active-class":"modal-enter-active","leave-active-class":"modal-leave-active"},{default:m(()=>[c(v,{size:"2xl",onClose:n[2]||(n[2]=i=>e.$emit("cancel"))},{header:m(()=>[t("div",te,[t("h3",ee,s(e.$t("Cancel Investment Confirmation")),1)])]),body:m(()=>[t("span",se,s(e.$t("Are you sure you want to perform this action"))+"?",1)]),footer:m(()=>[t("div",ne,[t("button",{type:"button",class:"btn btn-outline-danger mr-3",onClick:n[0]||(n[0]=i=>e.$emit("confirm"))},s(e.$t("Confirm")),1),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:n[1]||(n[1]=i=>e.$emit("cancel"))},s(e.$t("Cancel")),1)])]),_:1})]),_:1})}const ae=b(Zt,[["render",oe]]),le={components:{ConfirmationModal:ae},props:{log:{type:Object,required:!0}},emits:["cancel-log"],data(){return{showConfirmationModal:!1}},methods:{formatDate(e){return new Date(e).toLocaleDateString()},getStatusText(e){switch(e){case 1:return"Active";case 2:return"Completed";case 3:return"Cancelled";default:return""}},getStatusStyle(e){switch(e){case 1:return"bg-primary";case 2:return"bg-success";case 3:return"bg-danger";default:return""}},isCancelable(e){return e===1},cancelLog(){this.$emit("cancel-log",this.log.id),this.showConfirmationModal=!1}}},ie={class:"border-b bg-white dark:border-gray-700 dark:bg-gray-800"},de={class:"py-3 px-6"},re={class:"py-3 px-6"},ce={class:"py-3 px-6"},me={class:"py-3 px-6"},ue={class:"py-3 px-6"},_e={class:"py-3 px-6"},ve={class:"py-3 px-6"},he={class:"py-3 px-6"};function fe(e,n,o,l,a,r){const v=h("confirmation-modal");return d(),_("tr",ie,[t("td",de,s(o.log.trx),1),t("td",re,s(o.log.plan.name),1),t("td",ce,s(o.log.amount),1),t("td",me,s(o.log.profit),1),t("td",ue,s(r.formatDate(o.log.created_at)),1),t("td",_e,s(r.formatDate(o.log.end_date)),1),t("td",ve,[t("span",{class:j(["badge",r.getStatusStyle(o.log.status)])},s(r.getStatusText(o.log.status)),3)]),t("td",he,[r.isCancelable(o.log.status)?(d(),_("button",{key:0,class:"btn btn-sm btn-danger",onClick:n[0]||(n[0]=i=>a.showConfirmationModal=!0)},s(e.$t("Cancel")),1)):k("",!0),a.showConfirmationModal?(d(),w(v,{key:1,onConfirm:r.cancelLog,onCancel:n[1]||(n[1]=i=>a.showConfirmationModal=!1)},{default:m(()=>[$(s(e.$t("Are you sure you want to cancel this investment"))+"? ",1)]),_:1},8,["onConfirm"])):k("",!0)])])}const ge=b(le,[["render",fe]]),pe={components:{InvestmentLog:ge,Filter:O,Col:z},props:{logs:{type:Object,required:!0}},emits:["investment-cancel"],data(){return{filters:{trx:{value:"",keys:["trx"]}},currentPage:1,totalPages:0}},mounted(){console.log("Received logs from parent:",this.logs)},methods:{cancelLog(e){axios.post("/user/investment/log/cancel",{id:e}).then(n=>{this.$emit("investment-cancel"),this.$toast[n.type||"success"](n.message||"Investment cancelled successfully")}).catch(n=>{console.log(n),this.$toast[n.response.data.type||"error"](n.response.data.message||"Error cancelling investment")})}}},ye={class:"mb-4 items-center justify-between xs:block xs:space-y-5 sm:flex sm:space-y-0"},be={class:"font-medium"},$e={key:0,class:"card relative overflow-x-auto"},xe={class:"bg-gray-100 text-xs uppercase text-gray-700 dark:bg-gray-700 dark:text-gray-400"},we={scope:"col",class:"py-3 px-6"},ke={scope:"col",class:"py-3 px-6"},Ie={scope:"col",class:"py-3 px-6"},Ce={class:"py-3 px-6"},Pe={key:1,class:"border-b bg-white dark:border-gray-700 dark:bg-gray-800"},Me={colspan:"100%",class:"py-4 px-6"},Se={class:"sr-only"},Le=t("svg",{class:"h-5 w-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1),Te={class:"sr-only"},Ne=t("svg",{class:"h-5 w-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1);function De(e,n,o,l,a,r){const v=h("Filter"),i=h("Col"),u=h("VTh"),x=h("InvestmentLog"),I=h("VTable"),C=h("VTPagination");return d(),_("div",null,[t("div",ye,[t("div",be,s(e.$t("Investments Log")),1),c(v,null,{default:m(()=>[T(t("input",{"onUpdate:modelValue":n[0]||(n[0]=f=>a.filters.trx.value=f),type:"text",class:"filter-input",placeholder:"Transaction ID"},null,512),[[N,a.filters.trx.value]])]),_:1})]),o.logs!=null?(d(),_("div",$e,[c(I,{"current-page":a.currentPage,"onUpdate:currentPage":n[1]||(n[1]=f=>a.currentPage=f),class:"w-full text-left text-sm text-gray-500 dark:text-gray-400",data:o.logs,filters:a.filters,"page-size":20,"hide-sort-icons":!0,onTotalPagesChanged:n[2]||(n[2]=f=>a.totalPages=f)},{head:m(()=>[t("tr",xe,[c(u,{"sort-key":"id",scope:"col",class:"py-3 px-6"},{default:m(()=>[c(i,{text:"Transaction ID"})]),_:1}),t("th",we,[c(i,{text:"Plan"})]),t("th",ke,[c(i,{text:"Amount"})]),t("th",Ie,[c(i,{text:"Profit"})]),c(u,{"sort-key":"created_at",scope:"col",class:"py-3 px-6"},{default:m(()=>[c(i,{text:"Start Date"})]),_:1}),c(u,{"sort-key":"end_date",scope:"col",class:"py-3 px-6"},{default:m(()=>[c(i,{text:"End Date"})]),_:1}),c(u,{"sort-key":"status",scope:"col",class:"py-3 px-6"},{default:m(()=>[c(i,{text:"Status"})]),_:1}),t("th",Ce,s(e.$t("Actions")),1)])]),body:m(({rows:f})=>[o.logs.length>0?(d(!0),_(P,{key:0},S(f,p=>(d(),w(x,{key:p.id,log:p,onCancelLog:r.cancelLog},null,8,["log","onCancelLog"]))),128)):(d(),_("tr",Pe,[t("td",Me,s(e.$t("No results found!")),1)]))]),_:1},8,["current-page","data","filters"])])):k("",!0),c(C,{currentPage:a.currentPage,"onUpdate:currentPage":n[3]||(n[3]=f=>a.currentPage=f),class:"float-right flex items-center justify-between pt-4","aria-label":"Table navigation","total-pages":a.totalPages,"max-page-links":3,"boundary-links":!0},{firstPage:m(()=>[$(s(e.$t("First")),1)]),lastPage:m(()=>[$(s(e.$t("Last")),1)]),next:m(()=>[t("span",Se,s(e.$t("Next")),1),Le]),previous:m(()=>[t("span",Te,s(e.$t("Previous")),1),Ne]),_:1},8,["currentPage","total-pages"])])}const qe=b(pe,[["render",De]]),Ae={name:"InvestmentModal",components:{Modal:D,ButtonLoading:W},props:{plan:{type:Object,required:!0},wallet:{type:Object,required:!0}},emits:["investment-made","close-modal","wallet-created"],setup(){return{walletsStore:U()}},data(){return{amount:0,loading:!1,wallet_id:null}},methods:{CreateWallet(){this.walletsStore.create("USDT","funding"),this.$emit("wallet-created")},invest(){if(this.amount>this.plan.max_amount)return this.$toast.error(`Amount cannot be greater than ${this.plan.max_amount}`);if(this.amount<this.plan.min_amount)return this.$toast.error(`Amount cannot be less than ${this.plan.min_amount}`);this.loading=!0,axios.post("/user/investment/store",{investment_plan_id:this.plan.id,amount:this.amount}).then(e=>{this.$emit("investment-made"),this.$toast[e.type](e.message)}).catch(e=>{this.$emit("close-modal"),this.$toast[e.response.data.type](e.response.data.message)}).finally(()=>{this.loading=!1})}}},Ve={class:"flex items-center text-lg"},je={id:"modal-headline",class:"text-lg"},Be={class:"mb-5"},Fe={key:0},Oe={for:"wallet_id"},ze={class:"flex items-center"},Ue={class:"text-warning font-medium"},We={key:1},Ee={class:"text-success font-medium"},Re=["min","max"],Ke={class:"text-warning font-medium"},Xe={class:"text-warning font-medium"},Ge={class:"flex justify-end"},He=["disabled"];function Je(e,n,o,l,a,r){const v=h("ButtonLoading"),i=h("Modal");return d(),w(L,{name:"modal",mode:"out-in","enter-active-class":"modal-enter-active","leave-active-class":"modal-leave-active"},{default:m(()=>[c(i,{size:"2xl",onClose:n[4]||(n[4]=u=>e.$emit("close-modal"))},{header:m(()=>[t("div",Ve,[t("h3",je,s(e.$t("Invest in"))+" "+s(o.plan.name),1)])]),body:m(()=>[t("div",Be,[o.wallet?(d(),_("div",Fe,[t("label",Oe,"USDT "+s(e.$t("Funding Wallet"))+":",1),t("div",ze,[t("span",Ue,s(Number(o.wallet.balance).toFixed(2))+" "+s(o.wallet.symbol),1)])])):(d(),_("div",We,[t("button",{class:"btn btn-primary",onClick:n[0]||(n[0]=u=>r.CreateWallet())},s(e.$t("Create Wallet")),1)]))]),t("div",null,[t("label",null,[$(s(e.$t("Please enter the amount you wish to invest and click"))+' "',1),t("span",Ee,s(e.$t("Invest Now")),1),$('" ')]),T(t("input",{"onUpdate:modelValue":n[1]||(n[1]=u=>a.amount=u),type:"number",min:o.plan.min_amount,max:o.plan.max_amount,step:"1",class:"form-control",placeholder:"Enter investment amount"},null,8,Re),[[N,a.amount,void 0,{number:!0}]]),t("small",null,[t("span",Ke,s(e.$t("Min")),1),$(": "+s(o.plan.min_amount)+" / ",1),t("span",Xe,s(e.$t("Max")),1),$(": "+s(o.plan.max_amount),1)])])]),footer:m(()=>[t("div",Ge,[t("button",{type:"button",class:"btn btn-outline-success mr-3",disabled:a.loading||!o.wallet,onClick:n[2]||(n[2]=u=>r.invest())},[c(v,{loading:a.loading,text:"Invest Now"},null,8,["loading"])],8,He),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:n[3]||(n[3]=u=>e.$emit("close-modal"))}," Close ")])]),_:1})]),_:1})}const Qe=b(Ae,[["render",Je]]),Ye={name:"Investment",components:{InvestmentPlans:Yt,InvestmentLogs:qe,InvestmentModal:Qe},setup(){const e="Investment Plans and Logs",n=y([]),o=y([]),l=y([]),a=y(!1),r=y(null),v=y(0),i=y(0),u=y(0),x=()=>{axios.get("/user/investment").then(g=>{n.value=g.plans,o.value=g.logs,v.value=g.totalInvested,i.value=g.totalProfit,u.value=g.todayProfit,l.value=g.wallet,console.log("Total Profit:",i.value)}).catch(g=>{console.log(g)})},I=g=>{r.value=g,a.value=!0},C=()=>{a.value=!1},f=()=>{x(),a.value=!1},p=E(),M=B();async function q(){plat.kyc.kyc_status==1&&Number(plat.kyc.investments_restriction)===1&&(p.user||await p.fetch(),p.user.kyc_application||M.push("/identity"),p.user.kyc_application&&p.user.kyc_application.level<2&&p.user.kyc_application.status!=="approved"&&M.push("/identity"))}return F(()=>{q(),x()}),{pageTitle:e,plans:n,logs:o,wallet:l,showModal:a,selectedPlan:r,totalInvested:v,totalProfit:i,todayProfit:u,showInvestmentModal:I,closeInvestmentModal:C,completeInvestment:f}}},Ze={class:"space-y-5"};function ts(e,n,o,l,a,r){const v=h("investment-plans"),i=h("investment-logs"),u=h("investment-modal");return d(),_("div",Ze,[c(v,{plans:l.plans,"total-invested":l.totalInvested,"total-profit":l.totalProfit,"today-profit":l.todayProfit,onStartInvestment:l.showInvestmentModal},null,8,["plans","total-invested","total-profit","today-profit","onStartInvestment"]),c(i,{logs:l.logs,onInvestmentCancel:e.fetchData},null,8,["logs","onInvestmentCancel"]),l.showModal==!0?(d(),w(u,{key:0,plan:l.selectedPlan,wallet:l.wallet,onCloseModal:l.closeInvestmentModal,onInvestmentMade:l.completeInvestment,onWalletCreated:e.fetchData},null,8,["plan","wallet","onCloseModal","onInvestmentMade","onWalletCreated"])):k("",!0)])}const _s=b(Ye,[["render",ts]]);export{_s as default};
