import{u as N}from"./wallets-92ad6f06.js";import{t as P}from"./toMoney-88a56e62.js";import{t as S}from"./toDate-734c7690.js";import{F as B}from"./Filter-3bb21f90.js";import{C as U}from"./Col-3a6cbfed.js";import{_ as W,o,c as i,a,n as j,t as l,F as v,r as h,i as g,w as d,h as D,U as M,e as C,b as V,g as y,f,V as I,k,G as z,s as E,u as L,l as $,T as R}from"./bootstrap-249b0f62.js";import{K as A}from"./flowbite-vue-7e69f603.js";import{T as q}from"./TransactionTypeMain-b5f171f0.js";const K={props:{type:{type:[Number,String],required:!0}},computed:{transactionType(){switch(this.type){case"1":return"Deposit";case"2":return"Withdraw";case"3":case"4":case"5":case"6":return"Transfer";case"FT":return"Funding to Trading Transfer";case"FFU":return"Funding to Futures Transfer";case"FUT":return"Futures to Trading Transfer";case"FUF":return"Futures to Funding Transfer";case"TF":return"Trading to Funding Transfer";case"TFU":return"Trading to Futures Transfer";case 7:return"Unknown"}},transactionIcon(){switch(this.type){case"1":return"journal-arrow-down";case"2":return"journal-arrow-up";case"3":case"4":case"5":case"6":case"FT":case"FFU":case"FUT":case"FUF":case"TF":case"TFU":return"send";case 7:return"envelope"}},transactionIconClass(){switch(this.type){case"1":return"text-success";case"2":return"text-danger";case"3":case"4":case"5":case"6":case"7":case"FT":case"FFU":case"FUT":case"FUF":case"TF":case"TFU":return"text-warning"}}}},G={class:"bg-dark w-8 rounded px-2 py-1 shadow"},H={class:"ml-2"};function J(t,e,b,r,u,p){return o(),i(v,null,[a("div",G,[a("i",{class:j(p.transactionIconClass+" bi bi-"+p.transactionIcon)},null,2)]),a("div",H,l(p.transactionType),1)],64)}const O=W(K,[["render",J]]),Q={components:{toMoney:P,toDate:S,Filter:B,Col:U,TransactionType:O},props:{type:String},emits:["totalPagesChanged"],setup(){return{walletsStore:N()}},data(){return{filters:{symbol:{value:"",keys:["symbol"]}},currentPage:1,totalPages:0,provider,cur_symbol}}},X={class:"mb-4 items-center justify-between xs:block xs:space-y-5 sm:flex sm:space-y-0"},Y={class:"font-medium"},Z={class:"card relative overflow-x-auto"},ee={class:"bg-gray-100 text-xs uppercase text-gray-700 dark:bg-gray-700 dark:text-gray-400"},te={"sort-key":"date",scope:"col",class:"py-3 px-6"},ae={scope:"col",class:"py-3"},se={"data-label":"Type",class:"text-center flex justify-start py-2 items-center pl-3"},re={"data-label":"Date",class:"py-2 px-3"},ne={"data-label":"Amount",class:"py-2"},le={key:0},oe={key:0},ie={key:1,class:"badge bg-warning"},ce={"data-label":"Fee",class:"py-2"},ue={key:0},de={key:0},ye={key:1,class:"badge bg-warning"},ge={"data-label":"Received",class:"py-2"},me={key:0},fe={key:1,class:"badge bg-warning"},be={"data-label":"Status",class:"py-2"},pe={key:0,class:"badge bg-success"},he={key:1,class:"badge bg-warning"},we={key:2,class:"badge bg-danger"},ve={key:1,scope:"row",class:"whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"},ke={colspan:"100%",class:"py-4 px-6"},_e={class:"sr-only"},Te={class:"sr-only"};function Fe(t,e,b,r,u,p){const n=h("Filter"),c=h("Col"),w=h("VTh"),_=h("transaction-type"),T=h("toDate"),F=h("VTable"),x=h("VTPagination");return o(),i(v,null,[a("div",X,[a("div",Y,l(t.$t("Transactions")),1),g(n,null,{default:d(()=>[D(a("input",{"onUpdate:modelValue":e[0]||(e[0]=m=>u.filters.symbol.value=m),type:"text",class:"filter-input",placeholder:"Symbol"},null,512),[[M,u.filters.symbol.value]])]),_:1})]),a("div",Z,[(o(),C(F,{key:r.walletsStore.wallet_trx.length,"current-page":u.currentPage,"onUpdate:currentPage":e[1]||(e[1]=m=>u.currentPage=m),class:"w-full text-left text-sm text-gray-500 dark:text-gray-400",data:r.walletsStore.wallet_trx,filters:u.filters,"page-size":5,"hide-sort-icons":!0,onTotalPagesChanged:e[2]||(e[2]=m=>u.totalPages=m)},{head:d(()=>[a("tr",ee,[g(w,{"sort-key":"type",scope:"col",class:"py-3 pl-3"},{default:d(()=>[g(c,{text:"Type"})]),_:1}),a("th",te,l(t.$t("Date")),1),g(w,{"sort-key":"amount",scope:"col",class:"py-3"},{default:d(()=>[g(c,{text:"Amount"})]),_:1}),g(w,{"sort-key":"charge",scope:"col",class:"py-3"},{default:d(()=>[g(c,{text:"Fee"})]),_:1}),g(w,{"sort-key":"amount_recieved",scope:"col",class:"py-3"},{default:d(()=>[g(c,{text:"Recieved"})]),_:1}),a("th",ae,l(t.$t("Status")),1)])]),body:d(({rows:m})=>[r.walletsStore.wallet_trx.length>0?(o(!0),i(v,{key:0},V(m,s=>(o(),i("tr",{key:s.id,class:"border-b bg-white dark:border-gray-700 dark:bg-gray-800"},[a("td",se,[g(_,{type:s.type},null,8,["type"])]),a("td",re,[g(T,{time:s.created_at,full:!0},null,8,["time"])]),a("td",ne,[s.amount!=0?(o(),i("span",le,[y(l(parseFloat(s.amount))+" ",1),b.type=="funding"?(o(),i("span",oe,l(u.cur_symbol),1)):f("",!0)])):(o(),i("span",ie,l(t.$t("Pending")),1))]),a("td",ce,[b.type=="trading"&&s.type==2?(o(),i(v,{key:0},[y(l(parseFloat(s.fees)),1)],64)):(o(),i(v,{key:1},[s.charge!=null?(o(),i("span",ue,[y(l(parseFloat(s.charge))+" ",1),b.type=="funding"?(o(),i("span",de,l(u.cur_symbol),1)):f("",!0)])):(o(),i("span",ye,l(t.$t("Pending")),1))],64))]),a("td",ge,[s.amount_recieved!=0?(o(),i("span",me,l(parseFloat(s.amount_recieved)),1)):(o(),i("span",fe,l(t.$t("Pending")),1))]),a("td",be,[s.status==1?(o(),i("span",pe,l(t.$t("Completed")),1)):s.status==2?(o(),i("span",he,l(t.$t("Pending")),1)):s.status==3?(o(),i("span",we,l(t.$t("Rejected")),1)):f("",!0)])]))),128)):(o(),i("tr",ve,[a("td",ke,l(t.$t("No transaction found!")),1)]))]),_:1},8,["current-page","data","filters"]))]),g(x,{currentPage:u.currentPage,"onUpdate:currentPage":e[3]||(e[3]=m=>u.currentPage=m),class:"float-right flex items-center justify-between pt-4","aria-label":"Table navigation","total-pages":u.totalPages,"max-page-links":3,"boundary-links":!0},{firstPage:d(()=>[y(l(t.$t("First")),1)]),lastPage:d(()=>[y(l(t.$t("Last")),1)]),next:d(()=>[a("span",_e,l(t.$t("Next")),1),e[4]||(e[4]=a("svg",{class:"h-5 w-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[a("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1))]),previous:d(()=>[a("span",Te,l(t.$t("Previous")),1),e[5]||(e[5]=a("svg",{class:"h-5 w-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[a("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1))]),_:1},8,["currentPage","total-pages"])],64)}const tt=W(Q,[["render",Fe]]),xe={components:{Modal:A,Filter:B,Col:U,toMoney:P,toDate:S,TransactionTypeMain:q},setup(){const t=I(),e=N(),b=k(!1),r=k(!1),u=k(!1),p=k(!1),n=z({symbol:t.params.symbol,loading:!1,plat,isShowModal:{transfer:!1},target:null,amount:0,currency:null,futureCurrency:null});async function c(){if(e.currencies.length==0)try{await e.fetch()}catch(s){console.log(s)}e.currencies&&(n.currency=e.currencies.find(s=>s.symbol==t.params.symbol)),e.futureCurrencies&&(n.futureCurrency=e.futureCurrencies.find(s=>s.symbol==t.params.symbol)),n.currency&&(b.value=!!n.currency.tradingWallet,u.value=!!n.currency.fundingWallet,p.value=!!n.currency.ecoWallet),n.futureCurrency&&(r.value=!!n.futureCurrency.wallet)}async function w(){switch(t.params.type){case"trading":await e.fetchWallet(t.params.type,t.params.symbol,t.params.address);break;case"futures":await e.fetchFuturesWallet(t.params.symbol);break;case"funding":await e.fetchWallet(t.params.type,t.params.symbol,t.params.address);break;default:console.log("Invalid wallet type")}}E(()=>{e.wallet==null&&w(),c()}),L(t,()=>{e.wallet=[],e.wallet_trx=[],c()});function _(s){s.target.src="/assets/no-image.png"}function T(){n.amount<=0||n.amount>(t.params.type==="futures"?e.wallet.available:e.wallet.balance)?$toast.error("Invalid amount"):(n.loading=!0,axios.post("/user/wallet/transfer",{symbol:n.symbol,target:n.target,source:t.params.type,amount:n.amount.toString()}).then(s=>{$toast[s.type](s.message)}).catch(s=>{$toast.error(s.response.data.message)}).finally(()=>{t.params.type==="futures"?e.fetchFutureWallet(n.symbol):e.fetchWallet(t.params.type,n.symbol,t.params.address),e.fetch(),n.currency=e.currencies.find(s=>s.symbol==t.params.symbol),n.loading=!1,e.closeModal("transfer")}))}const F=$(()=>{let s=0;if(n.amount>0)switch(t.params.type){case"trading":s=Number(n.currency.tradingWallet.balance);break;case"futures":s=Number(n.futureCurrency.wallet.available);break;case"funding":s=Number(n.currency.fundingWallet.balance);break;case"eco":s=Number(n.currency.ecoWallet.balance);break;default:console.log("Invalid wallet type")}return Number(s-Number(n.amount)).toFixed(6)}),x=$(()=>{let s=0;if(n.amount>0)switch(n.target){case"trading":s=Number(n.currency.tradingWallet.balance);break;case"futures":s=Number(n.futureCurrency.wallet.available);break;case"funding":s=Number(n.currency.fundingWallet.balance);break;case"eco":s=Number(n.currency.ecoWallet.balance);break;default:console.log("Invalid wallet type")}return Number(s+Number(n.amount)).toFixed(6)});function m(){let s=0;switch(n.target){case"trading":s=Number(n.currency.tradingWallet.balance);break;case"futures":s=Number(n.futureCurrency.wallet.available);break;case"funding":s=Number(n.currency.fundingWallet.balance);break;case"eco":s=Number(n.currency.ecoWallet.balance);break;default:console.log("Invalid wallet type")}return s.toFixed(6)}return{walletsStore:e,hasFuturesWallet:r,hasTradingWallet:b,hasFundingWallet:u,hasEcoWallet:p,checkWalletTypes:c,state:n,onImageError:_,transferFunds:T,currentBalanceChange:F,targetBalanceChange:x,targetWalletBalance:m}}},Ce={class:"flex items-center text-lg"},We={key:0,class:"space-y-5 text-center"},$e={key:0},Ne={key:1,class:"flex justify-center"},Pe={key:2,class:"flex justify-center"},Se={key:3,class:"flex justify-center"},Be={key:1,class:"space-y-5"},Ue={for:"amount"},De=["max"],Me={class:"flex items-center justify-between"},je={class:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 w-full"},Ve={class:"text-sm text-gray-600 dark:text-gray-400"},Ie={class:"text-base dark:text-white"},ze={class:"text-danger"},Ee={class:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 w-full"},Le={class:"text-sm text-gray-600 dark:text-gray-400"},Re={class:"text-base dark:text-white"},Ae={class:"text-success"},qe={class:"flex justify-end space-x-2"},Ke=["disabled"];function Ge(t,e,b,r,u,p){const n=h("Modal");return o(),C(R,{name:"modal",mode:"out-in","enter-active-class":"modal-enter-active","leave-active-class":"modal-leave-active"},{default:d(()=>[r.walletsStore.isShowModal.transfer?(o(),C(n,{key:0,size:"3xl",onClose:e[8]||(e[8]=c=>r.walletsStore.closeModal("transfer"))},{header:d(()=>[a("div",Ce,l(t.$t("Transfer Funds")),1)]),body:d(()=>[r.state.showTransferDetails?f("",!0):(o(),i("div",We,[r.hasFundingWallet&&t.$route.params.type!=="funding"?(o(),i("div",$e,[a("button",{class:"btn btn-outline-warning flex justify-start",onClick:e[0]||(e[0]=c=>{r.state.target="funding",r.state.showTransferDetails=!0})},[e[9]||(e[9]=a("i",{class:"bi bi-chevron-right"},null,-1)),a("span",null,l(t.$t("Transfer to")+" "+r.state.symbol+" "+t.$t("Funding Wallet")),1)])])):f("",!0),r.hasTradingWallet&&t.$route.params.type!=="trading"?(o(),i("div",Ne,[a("button",{class:"btn btn-outline-primary",onClick:e[1]||(e[1]=c=>{r.state.target="trading",r.state.showTransferDetails=!0})},[e[10]||(e[10]=a("i",{class:"bi bi-chevron-right"},null,-1)),y(" "+l(t.$t("Transfer to")+" "+r.state.symbol+" "+t.$t("Trading Wallet")),1)])])):f("",!0),r.hasFuturesWallet&&t.$route.params.type!=="futures"?(o(),i("div",Pe,[a("button",{class:"btn btn-outline-success",onClick:e[2]||(e[2]=c=>{r.state.target="futures",r.state.showTransferDetails=!0})},[e[11]||(e[11]=a("i",{class:"bi bi-chevron-right"},null,-1)),y(" "+l(t.$t("Transfer to")+" "+r.state.symbol+" "+t.$t("Futures Wallet")),1)])])):f("",!0),r.hasEcoWallet&&t.$route.params.type!=="eco"?(o(),i("div",Se,[a("button",{class:"btn btn-outline-success",onClick:e[3]||(e[3]=c=>{r.state.target="eco",r.state.showTransferDetails=!0})},[e[12]||(e[12]=a("i",{class:"bi bi-chevron-right"},null,-1)),y(" "+l(t.$t("Transfer to")+" "+r.state.symbol+" "+t.$t("Primary Wallet")),1)])])):f("",!0)])),r.state.target?(o(),i("div",Be,[a("div",null,[a("label",Ue,l(t.$t("Amount")),1),D(a("input",{"onUpdate:modelValue":e[4]||(e[4]=c=>r.state.amount=c),type:"number",class:"form-control",min:"0",max:t.$route.params.type==="futures"?r.walletsStore.wallet.available:r.walletsStore.wallet.balance,step:"0.000001",required:""},null,8,De),[[M,r.state.amount]])]),a("div",Me,[a("div",je,[a("div",Ve,l(t.$t("Balance"))+": ",1),a("div",Ie,[y(l(Number(t.$route.params.type==="futures"?r.walletsStore.wallet.available:r.walletsStore.wallet.balance).toFixed(6))+" (",1),a("span",ze,l(r.currentBalanceChange),1),e[13]||(e[13]=y(") "))])]),e[15]||(e[15]=a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-16 h-16 mx-2"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})],-1)),a("div",Ee,[a("div",Le,l(t.$t("Target Wallet Balance"))+": ",1),a("div",Re,[y(l(r.targetWalletBalance())+" (",1),a("span",Ae,l(r.targetBalanceChange),1),e[14]||(e[14]=y(") "))])])])])):f("",!0)]),footer:d(()=>[a("div",qe,[r.state.showTransferDetails?(o(),i("button",{key:0,type:"button",class:"btn btn-outline-success",disabled:r.state.loading,onClick:e[5]||(e[5]=c=>r.transferFunds())},l(t.$t("Transfer")),9,Ke)):f("",!0),r.state.showTransferDetails?(o(),i("button",{key:1,type:"button",class:"btn btn-outline-secondary",onClick:e[6]||(e[6]=c=>{r.state.showTransferDetails=!1,r.state.target=""})},[e[16]||(e[16]=a("i",{class:"bi bi-chevron-left"},null,-1)),y(" "+l(t.$t("Back")),1)])):(o(),i("button",{key:2,type:"button",class:"btn btn-outline-secondary",onClick:e[7]||(e[7]=c=>r.walletsStore.closeModal("transfer"))},l(t.$t("Close")),1))])]),_:1})):f("",!0)]),_:1})}const at=W(xe,[["render",Ge]]);export{tt as T,at as a};
