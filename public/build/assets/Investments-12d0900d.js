import{_ as b,o as i,c as _,a as t,t as s,f as k,r as h,i as c,F as P,d as S,e as w,p as j,w as m,T as L,n as q,g as $,h as T,W as N,k as y,u as B,y as F}from"./bootstrap-26bee35b.js";import{K as D}from"./flowbite-vue-a1a41228.js";import{F as A}from"./Filter-8923840e.js";import{C as O}from"./Col-c267595d.js";import{u as W}from"./wallets-22de70af.js";import{B as U}from"./ButtonLoading-ed6e1165.js";import{u as z}from"./user-7d9b5f4d.js";import"./_commonjsHelpers-de833af9.js";import"./browser-77dd377d.js";import"./preload-helper-f61836a9.js";import"./axios-4a70c6fc.js";const E={props:{plan:Object,recommended:Boolean},emits:["show-investment-modal"],methods:{showInvestmentModal(e){this.$emit("show-investment-modal",e)}}},R={class:"card"},K={class:"card-header flex justify-between"},G={class:"text-lg font-semibold md:text-base"},H={key:0,class:"badge bg-success"},J={class:"card-body"},Q={class:""},X={class:"mt-4 flex flex-wrap justify-between"},Y={class:"mb-2 flex items-center md:mb-0"},Z=t("span",{class:"text-dark text-lg font-semibold md:text-base"},"$",-1),tt={class:"text-dark text-lg font-bold md:text-base"},et=t("span",{class:"text-lg font-semibold md:text-base"}," - $",-1),st={class:"text-lg font-bold md:text-base"},nt={class:"flex items-center"},ot={class:"mr-2"},at={class:"text-dark font-bold md:text-base"},lt={class:"mt-4 flex flex-wrap justify-between"},it={class:"mb-2 flex items-center md:mb-0"},dt={class:"mr-2"},rt={class:"text-dark font-bold md:text-base"},ct={class:"flex items-center"},mt={class:"mr-2"},ut={class:"text-dark font-bold md:text-base"},_t={class:"card-footer"};function vt(e,n,o,d,a,r){return i(),_("div",R,[t("div",K,[t("h3",G,s(o.plan.name),1),o.plan.recommanded==1?(i(),_("div",H,s(e.$t("Recommended")),1)):k("",!0)]),t("div",J,[t("p",Q,s(o.plan.description),1),t("div",X,[t("div",Y,[Z,t("span",tt,s(o.plan.min_amount),1),et,t("span",st,s(o.plan.max_amount),1)]),t("div",nt,[t("span",ot,s(e.$t("Duration"))+":",1),t("span",at,s(o.plan.duration_in_days)+s(e.$t("days")),1)])]),t("div",lt,[t("div",it,[t("span",dt,s(e.$t("Interest Rate"))+":",1),t("span",rt,s(o.plan.interest_rate)+"%",1)]),t("div",ct,[t("span",mt,s(e.$t("Total Investors"))+":",1),t("span",ut,s(o.plan.total_custom_investors),1)])])]),t("div",_t,[t("button",{type:"button",class:"w-full rounded bg-blue-500 py-2 px-4 font-semibold text-white shadow-lg transition-all duration-300 hover:bg-blue-600 hover:shadow-none focus:outline-none focus:ring",onClick:n[0]||(n[0]=v=>r.showInvestmentModal(o.plan))},s(e.$t("Invest Now")),1)])])}const ht=b(E,[["render",vt]]),ft={props:{totalInvested:{type:[Number,String],required:!0},totalProfit:{type:[Number,String],required:!0},todayProfit:{type:[Number,String],required:!0}}},gt={class:"grid grid-cols-1 gap-4 md:grid-cols-3"},pt={class:"card"},yt={class:"card-header"},bt={class:"card-title"},$t={class:"title-gradient"},xt={class:"card-body"},wt={class:"text-3xl font-bold"},kt={class:"card"},It={class:"card-header"},Ct={class:"card-title"},Pt={class:"title-gradient"},Mt={class:"card-body"},St={class:"text-3xl font-bold"},Lt={class:"card"},Tt={class:"card-header"},Nt={class:"card-title"},Dt={class:"title-gradient"},Vt={class:"card-body"},jt={class:"text-3xl font-bold"};function qt(e,n,o,d,a,r){return i(),_("div",gt,[t("div",pt,[t("div",yt,[t("div",bt,[t("div",$t,s(e.$t("Total Invested")),1)])]),t("div",xt,[t("div",wt,"$"+s(o.totalInvested),1)])]),t("div",kt,[t("div",It,[t("div",Ct,[t("div",Pt,s(e.$t("Total Profit")),1)])]),t("div",Mt,[t("div",St,"$"+s(o.totalProfit),1)])]),t("div",Lt,[t("div",Tt,[t("div",Nt,[t("div",Dt,s(e.$t("Today's Profit")),1)])]),t("div",Vt,[t("div",jt,"$"+s(o.todayProfit),1)])])])}const Bt=b(ft,[["render",qt]]),Ft={components:{InvestmentPlan:ht,InvestmentOverview:Bt},props:{plans:{type:Array,required:!0},totalInvested:{type:[Number,String],required:!0},totalProfit:{type:[Number,String],required:!0},todayProfit:{type:[Number,String],required:!0}},emits:["start-investment"],data(){return{isLoading:!0}},watch:{plans(e){e&&e.length>0?this.isLoading=!1:this.isLoading=!0}},methods:{startInvestment(e){this.$emit("start-investment",e)}}},At={class:"flex flex-col lg:flex-row lg:space-x-8"},Ot={class:"mt-5 w-full lg:w-3/4"},Wt={class:"text-xl font-semibold"},Ut={class:"mt-4"},zt={class:"grid gap-4 xs:grid-cols-1 md:grid-cols-2 lg:grid-cols-3"},Et={key:0},Rt=j('<div class="card animate-pulse"><div class="card-body"><div class="skeleton mb-2 h-4 w-3/4 rounded bg-gray-400"></div><div class="skeleton mb-2 h-4 w-1/2 rounded bg-gray-400"></div><div class="skeleton mb-2 h-4 w-3/4 rounded bg-gray-400"></div><div class="skeleton h-4 w-1/3 rounded bg-gray-400"></div></div><div class="card-footer"><div class="skeleton h-4 w-1/3 rounded bg-gray-400"></div></div></div>',1),Kt=[Rt],Gt={key:1},Ht={class:"rounded-md border border-gray-300 p-4 text-gray-500"},Jt={class:"text-center"};function Qt(e,n,o,d,a,r){const v=h("InvestmentOverview"),l=h("InvestmentPlan");return i(),_(P,null,[c(v,{"total-invested":o.totalInvested,"total-profit":o.totalProfit,"today-profit":o.todayProfit},null,8,["total-invested","total-profit","today-profit"]),t("div",At,[t("div",Ot,[t("h2",Wt,s(e.$t("Investment Plans")),1),t("div",Ut,[t("div",zt,[a.isLoading?(i(),_("div",Et,Kt)):o.plans.length===0?(i(),_("div",Gt,[t("div",Ht,[t("p",Jt,s(e.$t("No plans available at this time. Please check back later"))+". ",1)])])):(i(!0),_(P,{key:2},S(o.plans,(u,x)=>(i(),w(l,{key:x,plan:u,onShowInvestmentModal:I=>r.startInvestment(u)},null,8,["plan","onShowInvestmentModal"]))),128))])])])])],64)}const Xt=b(Ft,[["render",Qt]]),Yt={name:"ConfirmationModal",components:{Modal:D},emits:["cancel","confirm"]},Zt={class:"flex items-center text-lg"},te={id:"modal-headline",class:"text-lg"},ee={class:"font-medium"},se={class:"flex justify-end"};function ne(e,n,o,d,a,r){const v=h("Modal");return i(),w(L,{name:"modal",mode:"out-in","enter-active-class":"modal-enter-active","leave-active-class":"modal-leave-active"},{default:m(()=>[c(v,{size:"2xl",onClose:n[2]||(n[2]=l=>e.$emit("cancel"))},{header:m(()=>[t("div",Zt,[t("h3",te,s(e.$t("Cancel Investment Confirmation")),1)])]),body:m(()=>[t("span",ee,s(e.$t("Are you sure you want to perform this action"))+"?",1)]),footer:m(()=>[t("div",se,[t("button",{type:"button",class:"btn btn-outline-danger mr-3",onClick:n[0]||(n[0]=l=>e.$emit("confirm"))},s(e.$t("Confirm")),1),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:n[1]||(n[1]=l=>e.$emit("cancel"))},s(e.$t("Cancel")),1)])]),_:1})]),_:1})}const oe=b(Yt,[["render",ne]]),ae={components:{ConfirmationModal:oe},props:{log:{type:Object,required:!0}},emits:["cancel-log"],data(){return{showConfirmationModal:!1}},methods:{formatDate(e){return new Date(e).toLocaleDateString()},getStatusText(e){switch(e){case 1:return"Active";case 2:return"Completed";case 3:return"Cancelled";default:return""}},getStatusStyle(e){switch(e){case 1:return"bg-primary";case 2:return"bg-success";case 3:return"bg-danger";default:return""}},isCancelable(e){return e===1},cancelLog(){this.$emit("cancel-log",this.log.id),this.showConfirmationModal=!1}}},le={class:"border-b bg-white dark:border-gray-700 dark:bg-gray-800"},ie={class:"py-3 px-6"},de={class:"py-3 px-6"},re={class:"py-3 px-6"},ce={class:"py-3 px-6"},me={class:"py-3 px-6"},ue={class:"py-3 px-6"},_e={class:"py-3 px-6"},ve={class:"py-3 px-6"};function he(e,n,o,d,a,r){const v=h("confirmation-modal");return i(),_("tr",le,[t("td",ie,s(o.log.trx),1),t("td",de,s(o.log.plan.name),1),t("td",re,s(o.log.amount),1),t("td",ce,s(o.log.profit),1),t("td",me,s(r.formatDate(o.log.created_at)),1),t("td",ue,s(r.formatDate(o.log.end_date)),1),t("td",_e,[t("span",{class:q(["badge",r.getStatusStyle(o.log.status)])},s(r.getStatusText(o.log.status)),3)]),t("td",ve,[r.isCancelable(o.log.status)?(i(),_("button",{key:0,class:"btn btn-sm btn-danger",onClick:n[0]||(n[0]=l=>a.showConfirmationModal=!0)},s(e.$t("Cancel")),1)):k("",!0),a.showConfirmationModal?(i(),w(v,{key:1,onConfirm:r.cancelLog,onCancel:n[1]||(n[1]=l=>a.showConfirmationModal=!1)},{default:m(()=>[$(s(e.$t("Are you sure you want to cancel this investment"))+"? ",1)]),_:1},8,["onConfirm"])):k("",!0)])])}const fe=b(ae,[["render",he]]),ge={components:{InvestmentLog:fe,Filter:A,Col:O},props:{logs:{type:Object,required:!0}},emits:["investment-cancel"],data(){return{filters:{trx:{value:"",keys:["trx"]}},currentPage:1,totalPages:0}},mounted(){console.log("Received logs from parent:",this.logs)},methods:{cancelLog(e){axios.post("/user/investment/log/cancel",{id:e}).then(n=>{this.$emit("investment-cancel"),this.$toast[n.type||"success"](n.message||"Investment cancelled successfully")}).catch(n=>{console.log(n),this.$toast[n.response.data.type||"error"](n.response.data.message||"Error cancelling investment")})}}},pe={class:"mb-4 items-center justify-between xs:block xs:space-y-5 sm:flex sm:space-y-0"},ye={class:"font-medium"},be={key:0,class:"card relative overflow-x-auto"},$e={class:"bg-gray-100 text-xs uppercase text-gray-700 dark:bg-gray-700 dark:text-gray-400"},xe={scope:"col",class:"py-3 px-6"},we={scope:"col",class:"py-3 px-6"},ke={scope:"col",class:"py-3 px-6"},Ie={class:"py-3 px-6"},Ce={key:1,class:"border-b bg-white dark:border-gray-700 dark:bg-gray-800"},Pe={colspan:"100%",class:"py-4 px-6"},Me={class:"sr-only"},Se=t("svg",{class:"h-5 w-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1),Le={class:"sr-only"},Te=t("svg",{class:"h-5 w-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1);function Ne(e,n,o,d,a,r){const v=h("Filter"),l=h("Col"),u=h("VTh"),x=h("InvestmentLog"),I=h("VTable"),C=h("VTPagination");return i(),_("div",null,[t("div",pe,[t("div",ye,s(e.$t("Investments Log")),1),c(v,null,{default:m(()=>[T(t("input",{"onUpdate:modelValue":n[0]||(n[0]=f=>a.filters.trx.value=f),type:"text",class:"filter-input",placeholder:"Transaction ID"},null,512),[[N,a.filters.trx.value]])]),_:1})]),o.logs!=null?(i(),_("div",be,[c(I,{"current-page":a.currentPage,"onUpdate:currentPage":n[1]||(n[1]=f=>a.currentPage=f),class:"w-full text-left text-sm text-gray-500 dark:text-gray-400",data:o.logs,filters:a.filters,"page-size":20,"hide-sort-icons":!0,onTotalPagesChanged:n[2]||(n[2]=f=>a.totalPages=f)},{head:m(()=>[t("tr",$e,[c(u,{"sort-key":"id",scope:"col",class:"py-3 px-6"},{default:m(()=>[c(l,{text:"Transaction ID"})]),_:1}),t("th",xe,[c(l,{text:"Plan"})]),t("th",we,[c(l,{text:"Amount"})]),t("th",ke,[c(l,{text:"Profit"})]),c(u,{"sort-key":"created_at",scope:"col",class:"py-3 px-6"},{default:m(()=>[c(l,{text:"Start Date"})]),_:1}),c(u,{"sort-key":"end_date",scope:"col",class:"py-3 px-6"},{default:m(()=>[c(l,{text:"End Date"})]),_:1}),c(u,{"sort-key":"status",scope:"col",class:"py-3 px-6"},{default:m(()=>[c(l,{text:"Status"})]),_:1}),t("th",Ie,s(e.$t("Actions")),1)])]),body:m(({rows:f})=>[o.logs.length>0?(i(!0),_(P,{key:0},S(f,p=>(i(),w(x,{key:p.id,log:p,onCancelLog:r.cancelLog},null,8,["log","onCancelLog"]))),128)):(i(),_("tr",Ce,[t("td",Pe,s(e.$t("No results found!")),1)]))]),_:1},8,["current-page","data","filters"])])):k("",!0),c(C,{currentPage:a.currentPage,"onUpdate:currentPage":n[3]||(n[3]=f=>a.currentPage=f),class:"float-right flex items-center justify-between pt-4","aria-label":"Table navigation","total-pages":a.totalPages,"max-page-links":3,"boundary-links":!0},{firstPage:m(()=>[$(s(e.$t("First")),1)]),lastPage:m(()=>[$(s(e.$t("Last")),1)]),next:m(()=>[t("span",Me,s(e.$t("Next")),1),Se]),previous:m(()=>[t("span",Le,s(e.$t("Previous")),1),Te]),_:1},8,["currentPage","total-pages"])])}const De=b(ge,[["render",Ne]]),Ve={name:"InvestmentModal",components:{Modal:D,ButtonLoading:U},props:{plan:{type:Object,required:!0},wallet:{type:Object,required:!0}},emits:["investment-made","close-modal","wallet-created"],setup(){return{walletsStore:W()}},data(){return{amount:0,loading:!1,wallet_id:null}},methods:{CreateWallet(){this.walletsStore.create("USDT","funding"),this.$emit("wallet-created")},invest(){if(this.amount>this.plan.max_amount)return this.$toast.error(`Amount cannot be greater than ${this.plan.max_amount}`);if(this.amount<this.plan.min_amount)return this.$toast.error(`Amount cannot be less than ${this.plan.min_amount}`);this.loading=!0,axios.post("/user/investment/store",{investment_plan_id:this.plan.id,amount:this.amount}).then(e=>{this.$emit("investment-made"),this.$toast[e.type](e.message)}).catch(e=>{this.$emit("close-modal"),this.$toast[e.response.data.type](e.response.data.message)}).finally(()=>{this.loading=!1})}}},je={class:"flex items-center text-lg"},qe={id:"modal-headline",class:"text-lg"},Be={class:"mb-5"},Fe={key:0},Ae={for:"wallet_id"},Oe={class:"flex items-center"},We={class:"text-warning font-medium"},Ue={key:1},ze={class:"text-success font-medium"},Ee=["min","max"],Re={class:"text-warning font-medium"},Ke={class:"text-warning font-medium"},Ge={class:"flex justify-end"},He=["disabled"];function Je(e,n,o,d,a,r){const v=h("ButtonLoading"),l=h("Modal");return i(),w(L,{name:"modal",mode:"out-in","enter-active-class":"modal-enter-active","leave-active-class":"modal-leave-active"},{default:m(()=>[c(l,{size:"2xl",onClose:n[4]||(n[4]=u=>e.$emit("close-modal"))},{header:m(()=>[t("div",je,[t("h3",qe,s(e.$t("Invest in"))+" "+s(o.plan.name),1)])]),body:m(()=>[t("div",Be,[o.wallet?(i(),_("div",Fe,[t("label",Ae,"USDT "+s(e.$t("Funding Wallet"))+":",1),t("div",Oe,[t("span",We,s(Number(o.wallet.balance).toFixed(2))+" "+s(o.wallet.symbol),1)])])):(i(),_("div",Ue,[t("button",{class:"btn btn-primary",onClick:n[0]||(n[0]=u=>r.CreateWallet())},s(e.$t("Create Wallet")),1)]))]),t("div",null,[t("label",null,[$(s(e.$t("Please enter the amount you wish to invest and click"))+' "',1),t("span",ze,s(e.$t("Invest Now")),1),$('" ')]),T(t("input",{"onUpdate:modelValue":n[1]||(n[1]=u=>a.amount=u),type:"number",min:o.plan.min_amount,max:o.plan.max_amount,step:"1",class:"form-control",placeholder:"Enter investment amount"},null,8,Ee),[[N,a.amount,void 0,{number:!0}]]),t("small",null,[t("span",Re,s(e.$t("Min")),1),$(": "+s(o.plan.min_amount)+" / ",1),t("span",Ke,s(e.$t("Max")),1),$(": "+s(o.plan.max_amount),1)])])]),footer:m(()=>[t("div",Ge,[t("button",{type:"button",class:"btn btn-outline-success mr-3",disabled:a.loading||!o.wallet,onClick:n[2]||(n[2]=u=>r.invest())},[c(v,{loading:a.loading,text:"Invest Now"},null,8,["loading"])],8,He),t("button",{type:"button",class:"btn btn-outline-secondary",onClick:n[3]||(n[3]=u=>e.$emit("close-modal"))}," Close ")])]),_:1})]),_:1})}const Qe=b(Ve,[["render",Je]]),Xe={name:"Investment",components:{InvestmentPlans:Xt,InvestmentLogs:De,InvestmentModal:Qe},setup(){const e="Investment Plans and Logs",n=y([]),o=y([]),d=y([]),a=y(!1),r=y(null),v=y(0),l=y(0),u=y(0),x=()=>{axios.get("/user/investment").then(g=>{n.value=g.plans,o.value=g.logs,v.value=g.totalInvested,l.value=g.totalProfit,u.value=g.todayProfit,d.value=g.wallet,console.log("Total Profit:",l.value)}).catch(g=>{console.log(g)})},I=g=>{r.value=g,a.value=!0},C=()=>{a.value=!1},f=()=>{x(),a.value=!1},p=z(),M=B();async function V(){plat.kyc.kyc_status==1&&Number(plat.kyc.investments_restriction)===1&&(p.user||await p.fetch(),p.user.kyc_application||M.push("/identity"),p.user.kyc_application&&p.user.kyc_application.level<2&&p.user.kyc_application.status!=="approved"&&M.push("/identity"))}return F(()=>{V(),x()}),{pageTitle:e,plans:n,logs:o,wallet:d,showModal:a,selectedPlan:r,totalInvested:v,totalProfit:l,todayProfit:u,showInvestmentModal:I,closeInvestmentModal:C,completeInvestment:f}}},Ye={class:"space-y-5"};function Ze(e,n,o,d,a,r){const v=h("investment-plans"),l=h("investment-logs"),u=h("investment-modal");return i(),_("div",Ye,[c(v,{plans:d.plans,"total-invested":d.totalInvested,"total-profit":d.totalProfit,"today-profit":d.todayProfit,onStartInvestment:d.showInvestmentModal},null,8,["plans","total-invested","total-profit","today-profit","onStartInvestment"]),c(l,{logs:d.logs,onInvestmentCancel:e.fetchData},null,8,["logs","onInvestmentCancel"]),d.showModal==!0?(i(),w(u,{key:0,plan:d.selectedPlan,wallet:d.wallet,onCloseModal:d.closeInvestmentModal,onInvestmentMade:d.completeInvestment,onWalletCreated:e.fetchData},null,8,["plan","wallet","onCloseModal","onInvestmentMade","onWalletCreated"])):k("",!0)])}const ms=b(Xe,[["render",Ze]]);export{ms as default};
