import{_ as X,ag as Q,k,l as L,x as Y,r as I,o as m,c as p,a,t as C,h as Z,W as $,n as v,i as D,w as R,q as N,X as ee,f as O,F as U,d as K,e as z}from"./bootstrap-26bee35b.js";import{u as te}from"./market-8ae68380.js";/* empty css                                                                       */const ae={components:{RecycleScroller:Q},props:{list:{type:Array,required:!0},type:{type:String,required:!0},subtype:{type:String,required:!0},ifeco:{type:Boolean,default:!1},iffav:{type:Boolean,default:!1},auth:{type:Boolean,default:!0}},emits:["fetchFavs"],setup(y,{emit:t}){const r=k(""),e=k(!1),_=k(0),S=L(()=>{try{if(!y.list)return[];const g=[...r.value?y.list.filter(d=>d.symbol.toUpperCase().includes(r.value.toUpperCase())):y.list],F=[(d,b)=>d.symbol.localeCompare(b.symbol),(d,b)=>b.symbol.localeCompare(d.symbol),(d,b)=>b.price-d.price,(d,b)=>d.price-b.price,(d,b)=>b.change-d.change,(d,b)=>d.change-b.change];return _.value?g.sort(F[_.value-1]):g}catch(u){console.log(u)}});return Y([r,_],()=>{S.value}),{searchTerm:r,searched:e,filter:_,markets:S,priceFormatter:(u,g=8,F=",")=>{if(u==null||isNaN(u))return 0;const d=u<0,b=Math.abs(u),[j,E]=b.toString().split(".");let M=g-j.length;M=Math.min(Math.max(M,0),8);const V=E?parseFloat("0."+E).toFixed(M).slice(2):"0".repeat(M),A=j.replace(/\B(?=(\d{3})+(?!\d))/g,F);return d?`-${A}.${V}`:`${A}.${V}`},addToWatchlist:async(u,g,F)=>{try{const d=await axios.post("/user/watchlist/store",{currency:u,pair:g,type:F});t("fetchFavs"),$toast[d.type](d.message)}catch(d){$toast.error(d.response.data.message)}},removeFromWatchlist:async u=>{try{const g=await axios.post("/user/watchlist/delete",{id:u});t("fetchFavs"),$toast[g.type](g.message)}catch(g){$toast.error(g.response.data.message)}}}}},re={class:"mb-3 flex items-center"},se={for:"simple-search",class:"sr-only"},oe={class:"relative w-full"},le=a("div",{class:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3"},[a("svg",{"aria-hidden":"true",class:"h-4 w-4 text-gray-500 dark:text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[a("path",{"fill-rule":"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z","clip-rule":"evenodd"})])],-1),ne={class:"mb-2 flex justify-between text-start text-xs"},ie={class:"mr-1"},ce={class:"flex flex-col",style:{"font-size":"8px"}},de=a("span",{class:"mr-1"},"Change %",-1),ue={class:"flex flex-col",style:{"font-size":"8px"}},fe={class:"mr-1"},ye={class:"flex flex-col",style:{"font-size":"8px"}},ge={class:"flex justify-between text-start"},be=["onClick"],he=a("i",{class:"text-secondary bi bi-star mr-1"},null,-1),ve=[he],me={class:"text-dark fw-bold"},xe={class:"text-secondary fw-bold"};function ke(y,t,r,e,_,S){const w=I("router-link"),i=I("RecycleScroller");return m(),p("div",null,[a("div",re,[a("label",se,C(y.$t("Search")),1),a("div",oe,[le,Z(a("input",{id:"simple-search","onUpdate:modelValue":t[0]||(t[0]=o=>e.searchTerm=o),type:"text",class:"block w-full rounded border border-gray-300 bg-gray-50 p-1 pl-10 text-sm text-gray-900 focus:border-blue-500 focus:ring-blue-500 dark:border-gray-600 dark:bg-gray-700 dark:text-white dark:placeholder-gray-400 dark:focus:border-blue-500 dark:focus:ring-blue-500",placeholder:"Search"},null,512),[[$,e.searchTerm]])])]),a("div",ne,[a("a",{class:"flex",onClick:t[1]||(t[1]=o=>e.filter!=1?e.filter==2?e.filter=0:e.filter=1:e.filter=2)},[a("span",ie,C(y.$t("Market")),1),a("div",ce,[a("i",{class:v(["bi",e.filter==1?"text-warning bi-caret-up-fill":"bi-caret-up"]),style:{"line-height":"0px !important"}},null,2),a("i",{class:v(["bi",e.filter==2?"text-warning bi-caret-down-fill":"bi-caret-down"]),style:{"line-height":"0px !important"}},null,2)])]),a("a",{class:"flex",onClick:t[2]||(t[2]=o=>e.filter!=5?e.filter==6?e.filter=0:e.filter=5:e.filter=6)},[de,a("div",ue,[a("i",{class:v(["bi",e.filter==5?"text-warning bi-caret-up-fill":"bi-caret-up"]),style:{"line-height":"0px !important"}},null,2),a("i",{class:v(["bi",e.filter==6?"text-warning bi-caret-down-fill":"bi-caret-down"]),style:{"line-height":"0px !important"}},null,2)])]),a("a",{class:"flex",onClick:t[3]||(t[3]=o=>e.filter!=3?e.filter==4?e.filter=0:e.filter=3:e.filter=4)},[a("span",fe,C(y.$t("Price")),1),a("div",ye,[a("i",{class:v(["bi",e.filter==3?"text-warning bi-caret-up-fill":"bi-caret-up"]),style:{"line-height":"0px !important"}},null,2),a("i",{class:v(["bi",e.filter==4?"text-warning bi-caret-down-fill":"bi-caret-down"]),style:{"line-height":"0px !important"}},null,2)])])]),D(i,{class:"scroller text-xs",style:{"margin-right":"-10px"},items:e.markets,"item-size":22,"key-field":"symbol"},{default:R(({item:o})=>[a("div",ge,[a("div",null,[a("button",{type:"button",class:"not-watchlisted",style:{background:"transparent",border:"transparent"},onClick:N(u=>r.iffav?e.removeFromWatchlist(o.id):e.addToWatchlist(o.currency??o.base,o.pair??o.quote,r.ifeco?1:r.type=="futures"?3:2),["prevent"])},ve,8,be),D(w,{to:(r.auth?"/"+(r.iffav?o.type===3?"futures":o.type===2?"trade":r.type:r.type==="futures"?"futures":r.type):"")+"/"+(r.iffav&&o.type!==1?"":r.subtype!="non"?r.subtype+"/":"")+(o.currency??o.base)+(o.type===2||r.ifeco?"-":"/")+(o.pair??o.quote)},{default:R(()=>[a("span",me,C(o.currency??o.base)+"/",1),a("span",xe,C(o.pair??o.quote),1)]),_:2},1032,["to"])]),a("span",{class:v(["text-end",o.classChange])},C(e.priceFormatter(o.change,3)||""),3),a("span",{class:v(["text-end mr-1",o.class])},C(e.priceFormatter(o.price)||""),3)])]),_:1},8,["items"])])}const _e=X(ae,[["render",ke]]),we={components:{MarketList:_e},props:{type:{type:String,default:"trade"},subtype:{type:String,default:"all"},status:{type:String,default:"open"},auth:{type:Boolean,default:!0}},setup(y){const t=te(),r=ee(),e=k([]),_=k([]),S=window.ext,w=window.provider,i=k(r.path.includes("-")?"eco":"USDT"),o=k([]),u=k([]),g=k(!1),F=s=>i.value===s,d=s=>{i.value=s},b=async()=>{t.markets.length===0&&(y.type==="futures"?await t.fetch_futures():await t.fetch_markets())},j=async()=>{t.favs.length===0&&await t.fetch_favs()},E=async()=>{t.ecos.length===0&&await t.fetch_ecos()},M=()=>{const s=document.querySelector(".nf"),c=s.scrollLeft;s.scroll({left:c-200,behavior:"smooth"})},V=()=>{const s=document.querySelector(".nf"),c=s.scrollLeft;s.scroll({left:c+200,behavior:"smooth"})},A=s=>{s.forEach(c=>{const{tickerElement:l,newValue:n,symbol:f}=c,h=e.value[f];n>h?l.text(n).addClass("text-success").removeClass("text-danger"):n<h&&l.text(n).addClass("text-danger").removeClass("text-success"),e.value[f]=n})},P=s=>{s.forEach(c=>{const{tickerIcon:l,newValue:n,symbol:f}=c,h=e.value[f];n>h?l.addClass("bi-arrow-up text-success").removeClass("bi-arrow-down text-danger"):n<h&&l.addClass("bi-arrow-down text-danger").removeClass("bi-arrow-up text-success")})},G=s=>{s.forEach(c=>{const{changeElement:l,newValue:n,symbol:f}=c,h=e.value[f];n>h?l.text(`${B(n)}%`).addClass("bi-arrow-up text-success").removeClass("bi-arrow-down text-danger"):n<h?l.text(`${B(n)}%`).addClass("bi-arrow-down text-danger").removeClass("bi-arrow-up text-success"):l.text(`${B(n)}%`)})},B=(s,c=8,l=",")=>{if(s==null||isNaN(s))return 0;(c<0||c>100)&&(c=8),s=parseFloat(s).toFixed(c);let[n,f]=s.toString().split(".");return n=n.replace(/\B(?=(\d{3})+(?!\d))/g,l),s=f?`${n}.${f}`:n,s},q=s=>{try{for(const[c,l]of Object.entries(s))if(l.last&&t[x.value]&&t[x.value][i.value]&&t[x.value][i.value][l.symbol+T.value]){let n=l.last,f=l.percentage??l.info.change;t[x.value][i.value][l.symbol+T.value].price=n;const h=!e.value||n>e.value[l.symbol+T.value];t[x.value][i.value][l.symbol+T.value].class=h?"text-success":"text-danger",f&&(t[x.value][i.value][l.symbol+T.value].change=f,t[x.value][i.value][l.symbol+T.value].classChange=f>0?"text-success":"text-danger")}e.value=Object.fromEntries(Object.entries(s).map(([c,l])=>[l.symbol,l.last]))}catch{}},W=async()=>{if(t.exchange||await new Promise(s=>setTimeout(s,2e3)),t.exchange.has.watchTickers)for(;window.location.href.indexOf(`${r.params.symbol}/${r.params.currency}`)>-1;)try{const s=await t.exchange.watchTickers();q(s)}catch{break}else for(;window.location.href.indexOf(`${r.params.symbol}/${r.params.currency}`)>-1;){try{const s=await t.exchange.fetchTickers();q(s)}catch{break}await new Promise(s=>setTimeout(s,2e3))}};b(),y.status==="open"&&(y.auth&&j(),S.eco===1&&!r.path.includes("binary")&&y.type!=="futures"&&E()),i.value!=="eco"&&W();const H=L(()=>{if(!t[x.value])return{};const s={};for(const[c,l]of Object.entries(t[x.value])){s[c]={};for(const[n,f]of Object.entries(l))f.active===!0&&(s[c][n]=f)}return s}),J=L(()=>{const s=y.type==="futures"?t.futures??{}:t.markets??{},c={};for(const[l,n]of Object.entries(s))Object.values(n).some(h=>h.active===!0)&&(c[l]=n);return c}),T=L(()=>y.type==="futures"?`:${i.value}`:""),x=L(()=>y.type==="futures"?"futures":"markets");return{marketStore:t,old:e,oldChange:_,ext:S,provider:w,activeItem:i,tickerElements:o,changeElements:u,isLoading:g,isActive:F,setActive:d,scrollLeft:M,scrollRight:V,updateTickerElements:A,updateTickerIcons:P,updateChangeElements:G,priceFormatter:B,handle:q,loop:W,activeMarkets:H,filteredTabs:J,symbolType:T,marketType:x}}},pe={class:"Markets border border-gray-100 bg-white shadow dark:border-gray-700 dark:bg-gray-900 relative"},Ce={class:"mb-4 flex border-gray-200 dark:border-gray-800"},Se=a("i",{class:"bi bi-chevron-left text-warning"},null,-1),Fe=[Se],Te={id:"myTab",class:"nf flex-cols -mb-px flex overflow-x-hidden bg-gray-200 text-center text-sm font-medium dark:bg-gray-800 w-full",role:"tablist"},Me={key:0},Oe=a("i",{class:"bi bi-star bi-icon"},null,-1),Le=[Oe],je={key:1},Ee=a("i",{class:"bi bi-award bi-icon"},null,-1),Ve=[Ee],Ae=["onClick"],Be=a("i",{class:"bi bi-chevron-right text-warning fs-6"},null,-1),qe=[Be],ze={id:"myTabContent",class:"px-3"},Ie=["loading"];function Ne(y,t,r,e,_,S){const w=I("MarketList");return m(),p("div",pe,[a("div",Ce,[a("button",{class:"-mb-px bg-gray-200 px-1 hover:bg-gray-300 dark:bg-gray-800 dark:hover:bg-gray-700",onClick:t[0]||(t[0]=N(i=>e.scrollLeft(),["prevent"]))},Fe),a("ul",Te,[r.status=="open"&&r.auth?(m(),p("li",Me,[a("small",null,[a("a",{class:v(["inline-block px-2 py-1 text-gray-600 dark:text-gray-300",e.isActive("fav")?"border-gray-300 bg-white text-gray-700 dark:bg-gray-900 dark:text-gray-300":"cursor-pointer border-transparent bg-gray-200 text-gray-400 hover:border-gray-300 hover:bg-gray-300 hover:text-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-gray-300"]),onClick:t[1]||(t[1]=i=>e.setActive("fav"))},Le,2)])])):O("",!0),e.ext.eco==1&&e.marketStore.ecos!=""&&r.status=="open"&&r.type!=="binary"?(m(),p("li",je,[a("small",null,[a("a",{class:v(["inline-block px-2 py-1 text-gray-600 dark:text-gray-300",e.isActive("eco")?"border-gray-300 bg-white text-gray-700 dark:bg-gray-900 dark:text-gray-300":"cursor-pointer border-transparent bg-gray-200 text-gray-400 hover:border-gray-300 hover:bg-gray-300 hover:text-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-gray-300"]),onClick:t[2]||(t[2]=i=>e.setActive("eco"))},Ve,2)])])):O("",!0),(m(!0),p(U,null,K(e.filteredTabs,(i,o,u)=>(m(),p("li",{key:u},[a("small",null,[a("a",{class:v(["inline-block px-2 py-1 text-gray-600 dark:text-gray-300",e.isActive(o)?"border-gray-300 bg-white text-gray-700 dark:bg-gray-900 dark:text-gray-300":"cursor-pointer border-transparent bg-gray-200 text-gray-400 hover:border-gray-300 hover:bg-gray-300 hover:text-gray-600 dark:bg-gray-800 dark:hover:bg-gray-700 dark:hover:text-gray-300"]),onClick:g=>e.setActive(o)},C(o),11,Ae)])]))),128))]),a("button",{class:"-mb-px bg-gray-200 px-1 hover:bg-gray-300 dark:bg-gray-800 dark:hover:bg-gray-700",onClick:t[3]||(t[3]=N(i=>e.scrollRight(),["prevent"]))},qe)]),a("div",ze,[e.activeItem==="fav"&&r.status=="open"&&r.auth?(m(),z(w,{key:e.marketStore.favs.length,list:Object.values(e.marketStore.favs),type:r.type,subtype:r.subtype,iffav:!0,onFetchFavs:t[4]||(t[4]=i=>e.marketStore.fetch_favs())},null,8,["list","type","subtype"])):O("",!0),e.activeItem==="eco"&&r.status=="open"&&r.type!=="binary"&&r.auth?(m(),z(w,{key:e.marketStore.ecos.length,list:Object.values(e.marketStore.ecos),type:r.type,subtype:r.subtype,ifeco:!0,onFetchFavs:t[5]||(t[5]=i=>e.marketStore.fetch_favs())},null,8,["list","type","subtype"])):O("",!0),(m(!0),p(U,null,K(r.type==="futures"?e.marketStore.futures:e.marketStore.markets,(i,o,u)=>(m(),p("div",{key:u,class:v(e.isActive(o)?"":"hidden")},[e.activeItem===o?(m(),z(w,{key:i.length,list:Object.values(i),type:r.type,subtype:r.subtype,auth:r.auth,onFetchFavs:t[6]||(t[6]=g=>e.marketStore.fetch_favs())},null,8,["list","type","subtype","auth"])):O("",!0)],2))),128))]),a("LoadingCircles",{loading:e.isLoading},null,8,Ie)])}const Pe=X(we,[["render",Ne]]),Ue=Object.freeze(Object.defineProperty({__proto__:null,default:Pe},Symbol.toStringTag,{value:"Module"}));export{Pe as M,_e as a,Ue as b};
