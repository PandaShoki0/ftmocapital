import{_ as U,X as D,I as T,l as u,x as S,y as H,r as V,o as l,c as m,a as e,n as p,q as M,t as c,e as N,f as b,i as R}from"./bootstrap-26bee35b.js";import{L as q}from"./ListItem-eb946da8.js";import{u as W}from"./market-8ae68380.js";import{L as G}from"./LoadingCircles-9003259e.js";import"./_commonjsHelpers-de833af9.js";import"./browser-77dd377d.js";import"./preload-helper-f61836a9.js";import"./axios-4a70c6fc.js";/* empty css                                                                       */const X={components:{ListItem:q,LoadingCircles:G},setup(){const n=W(),h=D(),o=T({limit:{asks:12,bids:12},showMoreAsks:!1,showMoreBids:!1,sideLength:20,refreshRate:500,best_ask:"",best_ask_icon:"",lastUpdated:"",activeItem:"pills-graph",data:{},asks:Array.from({length:20},()=>[0,0,0,0]),bids:Array.from({length:20},()=>[0,0,0,0]),isLoading:!0,bestAsker:0}),t=h.params.symbol,x=h.params.currency,B=window.provider,k=h.meta.type==="futures"?"future":"market",v=u(()=>n[k]?A(n[k].precision.amount||1e-6):6),w=u(()=>n[k]?A(n[k].precision.price||1e-6):6);function A(s){if(Math.floor(s)===s)return 0;const i=s.toString(),a=/^(\d+\.?\d*|\.\d+)e([\+\-]\d+)$/.exec(i);if(a){const d=(a[1].split(".")[1]||"").length+parseInt(a[2]);return Math.min(d,8)}else{const r=i.split(".")[1]||"";return Math.min(r.length,8)}}function _(s,i=8,a=","){if(s==null||isNaN(s))return 0;(i<0||i>100)&&(i=8),s=parseFloat(s).toFixed(i);let[r,d]=s.toString().split(".");return r=r.replace(/\B(?=(\d{3})+(?!\d))/g,a),s=d?`${r}.${d}`:r,s}const g={sort(s){return s.sort((i,a)=>i[1]-a[1])},median(s){const i=Math.floor(s.length/3*2);return s[i][1]<1?1:s[i][1]},medianUnit(s,i,a){const r=[...s,...i];return this.median(this.sort(r))/a},width(s,i){if(i===0)return 1;const a=Math.round(Number(s)/i);return a<=0?1:Math.min(160,a)}};function O(s,i){const a=g.medianUnit(s,i,48);s.forEach(r=>{r.push({width:g.width(r[1],a)*2.5})}),i.forEach(r=>{r.push({width:g.width(r[1],a)*2.5})})}function z(){const s=[...o.asks,...o.bids],i=g.medianUnit(o.asks,o.bids,48);s.forEach(a=>{typeof a[2]!="number"&&(a[2].width=g.width(a[1],i)*2.5)})}const E={width:250,sortwidth:g,init:O};S(()=>o.asks,()=>{z()},{deep:!0}),S(()=>o.bids,()=>{z()},{deep:!0});const F=u(()=>(o.showMoreAsks?o.asks:o.asks.slice(0,o.limit.asks)).slice().reverse().map(([a,r,{width:d}])=>[_(a,w.value),_(r,v.value),_(a*r,w.value),d])),I=u(()=>o.bids.map(([s,i,{width:a}])=>[_(s,w.value),_(i,v.value),_(s*i,w.value),a]));async function L(s){const i=Date.now(),a=B==="bitget",r=a?s.asks.slice(0,o.sideLength):s.asks,d=a?s.bids.slice(0,o.sideLength):s.bids;E.init(d,r),r.sort((f,y)=>f[0]-y[0]),d.sort((f,y)=>f[0]-y[0]);const P=r[0][0]>o.bestAsker;o.best_ask=P?"text-success":"text-danger",o.best_ask_icon=P?"bi-arrow-up text-success":"bi-arrow-down text-danger",o.bestAsker=r[0][0],o.lastUpdated=i,o.asks.splice(0,o.sideLength,...r),o.bids.splice(0,o.sideLength,...d),n.bestAsk=r[0][0],n.bestBid=d[d.length-1][0],i-o.lastUpdated<=o.refreshRate&&(await new Promise(f=>requestAnimationFrame(f)),await new Promise(f=>setTimeout(f,o.refreshRate/2)))}async function C(){for(n.exchange||await new Promise(s=>setTimeout(s,1e3));window.location.href.indexOf(`${t}/${x}`)>-1;)try{const s=await n.exchange.watchOrderBook(`${t}/${x}`,o.sideLength);o.isLoading=!1,await L(s)}catch{break}}return H(()=>{C()}),{marketStore:n,state:o,formattedAsks:F,formattedBids:I,priceFormatter:_,updateOrderbook:L,loopOrderbook:C}}},j={class:"Orderbook border border-gray-100 bg-white shadow dark:border-gray-700 dark:bg-gray-900 relative"},J={class:"flex p-1 xs:hidden md:flex",role:"tablist"},K={class:"p-1"},Q={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"css-3kwgah",style:{margin:"0px","min-width":"0px","font-size":"24px",width:"1em",height:"1em"}},Y=e("path",{d:"M4 4h7v7H4V4z",fill:"#F6465D"},null,-1),Z=e("path",{d:"M4 13h7v7H4v-7z",fill:"#0ECB81"},null,-1),$=e("path",{d:"M13 4h7v4h-7V4zm0 6h7v4h-7v-4zm7 6h-7v4h7v-4z",fill:"currentColor"},null,-1),tt=[Y,Z,$],st={class:"p-1"},et={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"css-3kwgah",style:{margin:"0px","min-width":"0px","font-size":"24px",width:"1em",height:"1em"}},ot=e("path",{d:"M4 4h7v16H4V4z",fill:"#0ECB81"},null,-1),it=e("path",{d:"M13 4h7v4h-7V4zm0 6h7v4h-7v-4zm7 6h-7v4h7v-4z",fill:"currentColor"},null,-1),at=[ot,it],rt={class:"p-1"},nt={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",class:"css-3kwgah",style:{margin:"0px","min-width":"0px","font-size":"24px",width:"1em",height:"1em"}},dt=e("path",{d:"M4 4h7v16H4V4z",fill:"#F6465D"},null,-1),lt=e("path",{d:"M13 4h7v4h-7V4zm0 6h7v4h-7v-4zm7 6h-7v4h7v-4z",fill:"currentColor"},null,-1),ct=[dt,lt],ht={key:0,class:"Asks"},mt={style:{"overflow-x":"hidden"}},kt={class:""},wt={class:"text-start",style:{"padding-left":"5px"},scope:"col"},_t={class:"text-center if-sm",scope:"col"},ft={class:"text-end",style:{"padding-right":"5px"},scope:"col"},gt={class:"LastPrice xs:hidden md:block"},pt={class:"p-3"},vt={class:""},ut={key:1,class:"Bids"},bt={style:{"overflow-x":"hidden"}},xt={key:0,class:""},yt={class:"pl-2 text-start",scope:"col"},Mt={class:"text-center if-sm",scope:"col"},Bt={class:"text-end",scope:"col"},At={key:1,class:"xs:flex md:hidden"},zt={class:"pl-2 text-start",scope:"col"},Lt={class:"text-center if-sm",scope:"col"},Ct={class:"text-end",scope:"col"};function Pt(n,h,o,t,x,B){const k=V("ListItem"),v=V("loading-circles");return l(),m("div",j,[e("ul",J,[e("li",K,[e("button",{class:p({"text-gray-200 dark:text-gray-600":t.state.showMoreAsks||t.state.showMoreBids||t.state.showMoreAsks&&t.state.showMoreBids}),onClick:h[0]||(h[0]=M(w=>(t.state.showMoreAsks=!1,t.state.showMoreBids=!1,t.state.limit.asks=12,t.state.limit.bids=12),["prevent"]))},[(l(),m("svg",Q,tt))],2)]),e("li",st,[e("button",{class:p({"text-gray-200 dark:text-gray-600":!t.state.showMoreBids||t.state.showMoreAsks}),onClick:h[1]||(h[1]=M(w=>(t.state.showMoreAsks=!1,t.state.showMoreBids=!0,t.state.limit.asks=0,t.state.limit.bids=20),["prevent"]))},[(l(),m("svg",et,at))],2)]),e("li",rt,[e("button",{class:p({"text-gray-200 dark:text-gray-600":t.state.showMoreBids||!t.state.showMoreAsks}),onClick:h[2]||(h[2]=M(w=>(t.state.showMoreAsks=!0,t.state.showMoreBids=!1,t.state.limit.asks=20,t.state.limit.bids=0),["prevent"]))},[(l(),m("svg",nt,ct))],2)])]),(l(),m("div",{key:t.state.limit.asks,class:"OrderbookGrid"},[t.state.limit.asks!=0?(l(),m("div",ht,[e("table",mt,[e("thead",kt,[e("th",wt,c(n.$t("Price")),1),e("th",_t,c(n.$t("Amount")),1),e("th",ft,c(n.$t("Total")),1)]),e("tbody",null,[(l(),N(k,{key:t.state.showMoreBids,data:t.formattedAsks,type:"ask","show-less":t.state.showMoreBids,limit:t.state.limit.asks},null,8,["data","show-less","limit"]))])])])):b("",!0),e("div",gt,[e("div",pt,[e("span",vt,c(n.$t("Last Price"))+": ",1),e("span",{class:p(t.state.best_ask)},c(t.marketStore.bestAsk??""),3),e("i",{class:p(["bi",t.state.best_ask_icon])},null,2)])]),t.state.limit.bids!=0?(l(),m("div",ut,[e("table",bt,[t.state.limit.asks==0?(l(),m("thead",xt,[e("th",yt,c(n.$t("Price")),1),e("th",Mt,c(n.$t("Amount")),1),e("th",Bt,c(n.$t("Total")),1)])):b("",!0),t.state.limit.asks!=0?(l(),m("thead",At,[e("th",zt,c(n.$t("Price")),1),e("th",Lt,c(n.$t("Amount")),1),e("th",Ct,c(n.$t("Total")),1)])):b("",!0),e("tbody",null,[(l(),N(k,{key:t.state.showMoreAsks,data:t.formattedBids,type:"bid","show-less":t.state.showMoreAsks,limit:t.state.limit.bids},null,8,["data","show-less","limit"]))])])])):b("",!0)])),R(v,{loading:t.state.isLoading},null,8,["loading"])])}const Tt=U(X,[["render",Pt]]);export{Tt as default};
