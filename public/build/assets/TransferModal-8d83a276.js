import{u as N}from"./wallets-22de70af.js";import{t as P}from"./toMoney-6259e3a7.js";import{t as S}from"./toDate-6e0d13f3.js";import{F as B}from"./Filter-8923840e.js";import{C as U}from"./Col-c267595d.js";import{_ as W,o,c,a,n as j,t as l,F as w,r as h,i as g,w as d,h as D,W as M,e as C,d as I,g as y,f,X as V,k as v,I as z,s as E,x as L,l as $,T as R}from"./bootstrap-26bee35b.js";import{K as A}from"./flowbite-vue-a1a41228.js";import{T as q}from"./TransactionTypeMain-176f1a53.js";const K={props:{type:{type:[Number,String],required:!0}},computed:{transactionType(){switch(this.type){case"1":return"Deposit";case"2":return"Withdraw";case"3":case"4":case"5":case"6":return"Transfer";case"FT":return"Funding to Trading Transfer";case"FFU":return"Funding to Futures Transfer";case"FUT":return"Futures to Trading Transfer";case"FUF":return"Futures to Funding Transfer";case"TF":return"Trading to Funding Transfer";case"TFU":return"Trading to Futures Transfer";case 7:return"Unknown"}},transactionIcon(){switch(this.type){case"1":return"journal-arrow-down";case"2":return"journal-arrow-up";case"3":case"4":case"5":case"6":case"FT":case"FFU":case"FUT":case"FUF":case"TF":case"TFU":return"send";case 7:return"envelope"}},transactionIconClass(){switch(this.type){case"1":return"text-success";case"2":return"text-danger";case"3":case"4":case"5":case"6":case"7":case"FT":case"FFU":case"FUT":case"FUF":case"TF":case"TFU":return"text-warning"}}}},X={class:"bg-dark w-8 rounded px-2 py-1 shadow"},G={class:"ml-2"};function H(e,t,b,r,u,p){return o(),c(w,null,[a("div",X,[a("i",{class:j(p.transactionIconClass+" bi bi-"+p.transactionIcon)},null,2)]),a("div",G,l(p.transactionType),1)],64)}const J=W(K,[["render",H]]),O={components:{toMoney:P,toDate:S,Filter:B,Col:U,TransactionType:J},props:{type:String},emits:["totalPagesChanged"],setup(){return{walletsStore:N()}},data(){return{filters:{symbol:{value:"",keys:["symbol"]}},currentPage:1,totalPages:0,provider,cur_symbol}}},Q={class:"mb-4 items-center justify-between xs:block xs:space-y-5 sm:flex sm:space-y-0"},Y={class:"font-medium"},Z={class:"card relative overflow-x-auto"},ee={class:"bg-gray-100 text-xs uppercase text-gray-700 dark:bg-gray-700 dark:text-gray-400"},te={"sort-key":"date",scope:"col",class:"py-3 px-6"},ae={scope:"col",class:"py-3"},se={"data-label":"Type",class:"text-center flex justify-start py-2 items-center pl-3"},re={"data-label":"Date",class:"py-2 px-3"},ne={"data-label":"Amount",class:"py-2"},le={key:0},oe={key:0},ce={key:1,class:"badge bg-warning"},ie={"data-label":"Fee",class:"py-2"},ue={key:0},de={key:0},ye={key:1,class:"badge bg-warning"},ge={"data-label":"Received",class:"py-2"},me={key:0},fe={key:1,class:"badge bg-warning"},be={"data-label":"Status",class:"py-2"},pe={key:0,class:"badge bg-success"},he={key:1,class:"badge bg-warning"},_e={key:2,class:"badge bg-danger"},we={key:1,scope:"row",class:"whitespace-nowrap py-4 px-6 font-medium text-gray-900 dark:text-white"},ve={colspan:"100%",class:"py-4 px-6"},ke={class:"sr-only"},Te=a("svg",{class:"h-5 w-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[a("path",{"fill-rule":"evenodd",d:"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule":"evenodd"})],-1),Fe={class:"sr-only"},xe=a("svg",{class:"h-5 w-5","aria-hidden":"true",fill:"currentColor",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},[a("path",{"fill-rule":"evenodd",d:"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule":"evenodd"})],-1);function Ce(e,t,b,r,u,p){const n=h("Filter"),i=h("Col"),_=h("VTh"),k=h("transaction-type"),T=h("toDate"),F=h("VTable"),x=h("VTPagination");return o(),c(w,null,[a("div",Q,[a("div",Y,l(e.$t("Transactions")),1),g(n,null,{default:d(()=>[D(a("input",{"onUpdate:modelValue":t[0]||(t[0]=m=>u.filters.symbol.value=m),type:"text",class:"filter-input",placeholder:"Symbol"},null,512),[[M,u.filters.symbol.value]])]),_:1})]),a("div",Z,[(o(),C(F,{key:r.walletsStore.wallet_trx.length,"current-page":u.currentPage,"onUpdate:currentPage":t[1]||(t[1]=m=>u.currentPage=m),class:"w-full text-left text-sm text-gray-500 dark:text-gray-400",data:r.walletsStore.wallet_trx,filters:u.filters,"page-size":5,"hide-sort-icons":!0,onTotalPagesChanged:t[2]||(t[2]=m=>u.totalPages=m)},{head:d(()=>[a("tr",ee,[g(_,{"sort-key":"type",scope:"col",class:"py-3 pl-3"},{default:d(()=>[g(i,{text:"Type"})]),_:1}),a("th",te,l(e.$t("Date")),1),g(_,{"sort-key":"amount",scope:"col",class:"py-3"},{default:d(()=>[g(i,{text:"Amount"})]),_:1}),g(_,{"sort-key":"charge",scope:"col",class:"py-3"},{default:d(()=>[g(i,{text:"Fee"})]),_:1}),g(_,{"sort-key":"amount_recieved",scope:"col",class:"py-3"},{default:d(()=>[g(i,{text:"Recieved"})]),_:1}),a("th",ae,l(e.$t("Status")),1)])]),body:d(({rows:m})=>[r.walletsStore.wallet_trx.length>0?(o(!0),c(w,{key:0},I(m,s=>(o(),c("tr",{key:s.id,class:"border-b bg-white dark:border-gray-700 dark:bg-gray-800"},[a("td",se,[g(k,{type:s.type},null,8,["type"])]),a("td",re,[g(T,{time:s.created_at,full:!0},null,8,["time"])]),a("td",ne,[s.amount!=0?(o(),c("span",le,[y(l(parseFloat(s.amount))+" ",1),b.type=="funding"?(o(),c("span",oe,l(u.cur_symbol),1)):f("",!0)])):(o(),c("span",ce,l(e.$t("Pending")),1))]),a("td",ie,[b.type=="trading"&&s.type==2?(o(),c(w,{key:0},[y(l(parseFloat(s.fees)),1)],64)):(o(),c(w,{key:1},[s.charge!=null?(o(),c("span",ue,[y(l(parseFloat(s.charge))+" ",1),b.type=="funding"?(o(),c("span",de,l(u.cur_symbol),1)):f("",!0)])):(o(),c("span",ye,l(e.$t("Pending")),1))],64))]),a("td",ge,[s.amount_recieved!=0?(o(),c("span",me,l(parseFloat(s.amount_recieved)),1)):(o(),c("span",fe,l(e.$t("Pending")),1))]),a("td",be,[s.status==1?(o(),c("span",pe,l(e.$t("Completed")),1)):s.status==2?(o(),c("span",he,l(e.$t("Pending")),1)):s.status==3?(o(),c("span",_e,l(e.$t("Rejected")),1)):f("",!0)])]))),128)):(o(),c("tr",we,[a("td",ve,l(e.$t("No transaction found!")),1)]))]),_:1},8,["current-page","data","filters"]))]),g(x,{currentPage:u.currentPage,"onUpdate:currentPage":t[3]||(t[3]=m=>u.currentPage=m),class:"float-right flex items-center justify-between pt-4","aria-label":"Table navigation","total-pages":u.totalPages,"max-page-links":3,"boundary-links":!0},{firstPage:d(()=>[y(l(e.$t("First")),1)]),lastPage:d(()=>[y(l(e.$t("Last")),1)]),next:d(()=>[a("span",ke,l(e.$t("Next")),1),Te]),previous:d(()=>[a("span",Fe,l(e.$t("Previous")),1),xe]),_:1},8,["currentPage","total-pages"])],64)}const it=W(O,[["render",Ce]]),We={components:{Modal:A,Filter:B,Col:U,toMoney:P,toDate:S,TransactionTypeMain:q},setup(){const e=V(),t=N(),b=v(!1),r=v(!1),u=v(!1),p=v(!1),n=z({symbol:e.params.symbol,loading:!1,plat,isShowModal:{transfer:!1},target:null,amount:0,currency:null,futureCurrency:null});async function i(){if(t.currencies.length==0)try{await t.fetch()}catch(s){console.log(s)}t.currencies&&(n.currency=t.currencies.find(s=>s.symbol==e.params.symbol)),t.futureCurrencies&&(n.futureCurrency=t.futureCurrencies.find(s=>s.symbol==e.params.symbol)),n.currency&&(b.value=!!n.currency.tradingWallet,u.value=!!n.currency.fundingWallet,p.value=!!n.currency.ecoWallet),n.futureCurrency&&(r.value=!!n.futureCurrency.wallet)}async function _(){switch(e.params.type){case"trading":await t.fetchWallet(e.params.type,e.params.symbol,e.params.address);break;case"futures":await t.fetchFuturesWallet(e.params.symbol);break;case"funding":await t.fetchWallet(e.params.type,e.params.symbol,e.params.address);break;default:console.log("Invalid wallet type")}}E(()=>{t.wallet==null&&_(),i()}),L(e,()=>{t.wallet=[],t.wallet_trx=[],i()});function k(s){s.target.src="/assets/no-image.png"}function T(){n.amount<=0||n.amount>(e.params.type==="futures"?t.wallet.available:t.wallet.balance)?$toast.error("Invalid amount"):(n.loading=!0,axios.post("/user/wallet/transfer",{symbol:n.symbol,target:n.target,source:e.params.type,amount:n.amount.toString()}).then(s=>{$toast[s.type](s.message)}).catch(s=>{$toast.error(s.response.data.message)}).finally(()=>{e.params.type==="futures"?t.fetchFutureWallet(n.symbol):t.fetchWallet(e.params.type,n.symbol,e.params.address),t.fetch(),n.currency=t.currencies.find(s=>s.symbol==e.params.symbol),n.loading=!1,t.closeModal("transfer")}))}const F=$(()=>{let s=0;if(n.amount>0)switch(e.params.type){case"trading":s=Number(n.currency.tradingWallet.balance);break;case"futures":s=Number(n.futureCurrency.wallet.available);break;case"funding":s=Number(n.currency.fundingWallet.balance);break;case"eco":s=Number(n.currency.ecoWallet.balance);break;default:console.log("Invalid wallet type")}return Number(s-Number(n.amount)).toFixed(6)}),x=$(()=>{let s=0;if(n.amount>0)switch(n.target){case"trading":s=Number(n.currency.tradingWallet.balance);break;case"futures":s=Number(n.futureCurrency.wallet.available);break;case"funding":s=Number(n.currency.fundingWallet.balance);break;case"eco":s=Number(n.currency.ecoWallet.balance);break;default:console.log("Invalid wallet type")}return Number(s+Number(n.amount)).toFixed(6)});function m(){let s=0;switch(n.target){case"trading":s=Number(n.currency.tradingWallet.balance);break;case"futures":s=Number(n.futureCurrency.wallet.available);break;case"funding":s=Number(n.currency.fundingWallet.balance);break;case"eco":s=Number(n.currency.ecoWallet.balance);break;default:console.log("Invalid wallet type")}return s.toFixed(6)}return{walletsStore:t,hasFuturesWallet:r,hasTradingWallet:b,hasFundingWallet:u,hasEcoWallet:p,checkWalletTypes:i,state:n,onImageError:k,transferFunds:T,currentBalanceChange:F,targetBalanceChange:x,targetWalletBalance:m}}},$e={class:"flex items-center text-lg"},Ne={key:0,class:"space-y-5 text-center"},Pe={key:0},Se=a("i",{class:"bi bi-chevron-right"},null,-1),Be={key:1,class:"flex justify-center"},Ue=a("i",{class:"bi bi-chevron-right"},null,-1),De={key:2,class:"flex justify-center"},Me=a("i",{class:"bi bi-chevron-right"},null,-1),je={key:3,class:"flex justify-center"},Ie=a("i",{class:"bi bi-chevron-right"},null,-1),Ve={key:1,class:"space-y-5"},ze={for:"amount"},Ee=["max"],Le={class:"flex items-center justify-between"},Re={class:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 w-full"},Ae={class:"text-sm text-gray-600 dark:text-gray-400"},qe={class:"text-base dark:text-white"},Ke={class:"text-danger"},Xe=a("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"w-16 h-16 mx-2"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.25 4.5l7.5 7.5-7.5 7.5"})],-1),Ge={class:"bg-white dark:bg-gray-800 rounded-lg shadow-md p-4 w-full"},He={class:"text-sm text-gray-600 dark:text-gray-400"},Je={class:"text-base dark:text-white"},Oe={class:"text-success"},Qe={class:"flex justify-end space-x-2"},Ye=["disabled"],Ze=a("i",{class:"bi bi-chevron-left"},null,-1);function et(e,t,b,r,u,p){const n=h("Modal");return o(),C(R,{name:"modal",mode:"out-in","enter-active-class":"modal-enter-active","leave-active-class":"modal-leave-active"},{default:d(()=>[r.walletsStore.isShowModal.transfer?(o(),C(n,{key:0,size:"3xl",onClose:t[8]||(t[8]=i=>r.walletsStore.closeModal("transfer"))},{header:d(()=>[a("div",$e,l(e.$t("Transfer Funds")),1)]),body:d(()=>[r.state.showTransferDetails?f("",!0):(o(),c("div",Ne,[r.hasFundingWallet&&e.$route.params.type!=="funding"?(o(),c("div",Pe,[a("button",{class:"btn btn-outline-warning flex justify-start",onClick:t[0]||(t[0]=i=>{r.state.target="funding",r.state.showTransferDetails=!0})},[Se,a("span",null,l(e.$t("Transfer to")+" "+r.state.symbol+" "+e.$t("Funding Wallet")),1)])])):f("",!0),r.hasTradingWallet&&e.$route.params.type!=="trading"?(o(),c("div",Be,[a("button",{class:"btn btn-outline-primary",onClick:t[1]||(t[1]=i=>{r.state.target="trading",r.state.showTransferDetails=!0})},[Ue,y(" "+l(e.$t("Transfer to")+" "+r.state.symbol+" "+e.$t("Trading Wallet")),1)])])):f("",!0),r.hasFuturesWallet&&e.$route.params.type!=="futures"?(o(),c("div",De,[a("button",{class:"btn btn-outline-success",onClick:t[2]||(t[2]=i=>{r.state.target="futures",r.state.showTransferDetails=!0})},[Me,y(" "+l(e.$t("Transfer to")+" "+r.state.symbol+" "+e.$t("Futures Wallet")),1)])])):f("",!0),r.hasEcoWallet&&e.$route.params.type!=="eco"?(o(),c("div",je,[a("button",{class:"btn btn-outline-success",onClick:t[3]||(t[3]=i=>{r.state.target="eco",r.state.showTransferDetails=!0})},[Ie,y(" "+l(e.$t("Transfer to")+" "+r.state.symbol+" "+e.$t("Primary Wallet")),1)])])):f("",!0)])),r.state.target?(o(),c("div",Ve,[a("div",null,[a("label",ze,l(e.$t("Amount")),1),D(a("input",{"onUpdate:modelValue":t[4]||(t[4]=i=>r.state.amount=i),type:"number",class:"form-control",min:"0",max:e.$route.params.type==="futures"?r.walletsStore.wallet.available:r.walletsStore.wallet.balance,step:"0.000001",required:""},null,8,Ee),[[M,r.state.amount]])]),a("div",Le,[a("div",Re,[a("div",Ae,l(e.$t("Balance"))+": ",1),a("div",qe,[y(l(Number(e.$route.params.type==="futures"?r.walletsStore.wallet.available:r.walletsStore.wallet.balance).toFixed(6))+" (",1),a("span",Ke,l(r.currentBalanceChange),1),y(") ")])]),Xe,a("div",Ge,[a("div",He,l(e.$t("Target Wallet Balance"))+": ",1),a("div",Je,[y(l(r.targetWalletBalance())+" (",1),a("span",Oe,l(r.targetBalanceChange),1),y(") ")])])])])):f("",!0)]),footer:d(()=>[a("div",Qe,[r.state.showTransferDetails?(o(),c("button",{key:0,type:"button",class:"btn btn-outline-success",disabled:r.state.loading,onClick:t[5]||(t[5]=i=>r.transferFunds())},l(e.$t("Transfer")),9,Ye)):f("",!0),r.state.showTransferDetails?(o(),c("button",{key:1,type:"button",class:"btn btn-outline-secondary",onClick:t[6]||(t[6]=i=>{r.state.showTransferDetails=!1,r.state.target=""})},[Ze,y(" "+l(e.$t("Back")),1)])):(o(),c("button",{key:2,type:"button",class:"btn btn-outline-secondary",onClick:t[7]||(t[7]=i=>r.walletsStore.closeModal("transfer"))},l(e.$t("Close")),1))])]),_:1})):f("",!0)]),_:1})}const ut=W(We,[["render",et]]);export{it as T,ut as a};
